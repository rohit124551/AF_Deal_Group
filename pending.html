<!doctype html>
<html lang=en>
  <head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<base target=_top>
<title>Pending Order Lookup Portal</title>
<link rel=apple-touch-icon sizes=180x180 href=favicon_io/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=favicon_io/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=favicon_io/favicon-16x16.png>
<link rel=manifest href=favicon_io/site.webmanifest>
<link rel=icon type=image/png sizes=192x192 href=favicon_io/android-chrome-192x192.png>
<link rel=icon type=image/png sizes=512x512 href=favicon_io/android-chrome-512x512.png>
<link rel="shortcut icon" href=favicon_io/favicon.ico>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel=stylesheet>
<link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css rel=stylesheet>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js></script>
<style>*{margin:0;padding:0;box-sizing:border-box}:root{--primary-gradient:linear-gradient(135deg, #667eea 0%, #764ba2 100%);--secondary-gradient:linear-gradient(135deg, #f093fb 0%, #f5576c 100%);--success-gradient:linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);--warning-gradient:linear-gradient(135deg, #fa709a 0%, #fee140 100%);--error-gradient:linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);--glass-bg:rgba(255, 255, 255, 0.25);--glass-border:rgba(255, 255, 255, 0.18);--shadow-light:0 8px 32px rgba(31, 38, 135, 0.37);--shadow-medium:0 15px 35px rgba(0, 0, 0, 0.1);--shadow-heavy:0 25px 50px rgba(0, 0, 0, 0.15);--border-radius:20px;--border-radius-small:12px;--transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1)}body{font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0,#764ba2 50%,#f093fb 100%);min-height:100vh;padding:20px;color:#333;position:relative;overflow-x:hidden}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 80%,rgba(120,119,198,.3) 0,transparent 50%),radial-gradient(circle at 80% 20%,rgba(255,119,198,.3) 0,transparent 50%),radial-gradient(circle at 40% 40%,rgba(120,219,255,.2) 0,transparent 50%);pointer-events:none;z-index:-1}.container{max-width:1200px;margin:0 auto;background:var(--glass-bg);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-radius:var(--border-radius);padding:40px;box-shadow:var(--shadow-light);border:1px solid var(--glass-border);animation:slideInUp .8s ease-out}@keyframes slideInUp{from{opacity:0;transform:translateY(50px)}to{opacity:1;transform:translateY(0)}}.header{text-align:center;margin-bottom:40px;position:relative}.header h2{font-size:2.5rem;font-weight:800;background:var(--primary-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:10px;animation:fadeInDown 1s ease-out}.header::after{content:'';position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:80px;height:4px;background:var(--primary-gradient);border-radius:2px;animation:expandWidth .8s ease-out .5s both}@keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes expandWidth{from{width:0}to{width:80px}}.search-section{background:rgba(255,255,255,.1);border-radius:var(--border-radius-small);padding:30px;margin-bottom:30px;border:1px solid rgba(255,255,255,.2);animation:fadeIn 1.2s ease-out .3s both}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.search-form{display:grid;grid-template-columns:1fr 2fr auto;gap:20px;align-items:end}.form-group{display:flex;flex-direction:column;gap:8px}.form-group label{font-weight:600;color:#4a5568;font-size:.95rem;text-transform:uppercase;letter-spacing:.5px}.form-control{padding:15px 20px;border:2px solid rgba(255,255,255,.3);border-radius:var(--border-radius-small);background:rgba(255,255,255,.9);font-size:1rem;transition:var(--transition);outline:0;backdrop-filter:blur(10px)}.form-control:focus{border-color:#667eea;box-shadow:0 0 0 4px rgba(102,126,234,.1);transform:translateY(-2px)}.form-control:hover{border-color:#667eea;transform:translateY(-1px)}select.form-control{cursor:pointer;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");background-position:right 12px center;background-repeat:no-repeat;background-size:16px;padding-right:40px;appearance:none}.btn{padding:15px 30px;border:none;border-radius:var(--border-radius-small);font-weight:600;font-size:1rem;cursor:pointer;transition:var(--transition);position:relative;overflow:hidden;text-transform:uppercase;letter-spacing:.5px;min-width:120px}.btn-primary{background:var(--primary-gradient);color:#fff;box-shadow:var(--shadow-medium)}.btn-primary:hover{transform:translateY(-3px);box-shadow:0 20px 40px rgba(102,126,234,.3)}.btn-primary:active{transform:translateY(-1px)}.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn:hover::before{left:100%}.status-section{margin:20px 0;animation:slideInLeft .6s ease-out}@keyframes slideInLeft{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}.status-message{padding:15px 20px;border-radius:var(--border-radius-small);font-weight:600;text-align:center;margin:10px 0;position:relative;overflow:hidden}.status-message::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .8s}.status-message:hover::before{left:100%}.status-info{background:var(--success-gradient);color:#fff}.status-error{background:var(--error-gradient);color:#d53f8c}.status-warning{background:var(--warning-gradient);color:#d69e2e}.input-log{font-style:italic;color:#718096;margin:15px 0;padding:12px 20px;background:rgba(255,255,255,.8);border-radius:var(--border-radius-small);border-left:4px solid #667eea;animation:slideInLeft .6s ease-out}.results-section{margin-top:30px;animation:fadeInUp .8s ease-out}@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.results-table{width:100%;border-collapse:separate;border-spacing:0;background:rgba(255,255,255,.95);border-radius:var(--border-radius-small);overflow:hidden;box-shadow:var(--shadow-medium);animation:scaleIn .6s ease-out}@keyframes scaleIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.results-table th{background:var(--primary-gradient);color:#fff;padding:18px 15px;text-align:left;font-weight:600;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px;position:sticky;top:0;z-index:10}.results-table td{padding:15px;border-bottom:1px solid rgba(0,0,0,.05);transition:var(--transition)}.results-table tr:hover td{background:rgba(102,126,234,.05);transform:scale(1.01)}.results-table tr:last-child td{border-bottom:none}.loading{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#667eea;animation:spin 1s ease-in-out infinite;margin-right:10px}@keyframes spin{to{transform:rotate(360deg)}}.empty-state{text-align:center;padding:60px 20px;color:#718096}.empty-state i{font-size:4rem;margin-bottom:20px;opacity:.5}.empty-state h3{font-size:1.5rem;margin-bottom:10px;color:#4a5568}.empty-state p{font-size:1rem;line-height:1.6}@media (max-width:768px){body{padding:10px}.container{padding:20px;border-radius:15px}.header h2{font-size:2rem}.search-form{grid-template-columns:1fr;gap:15px}.form-control{padding:12px 15px;font-size:16px}.btn{padding:12px 20px;font-size:16px;width:100%}.results-table{font-size:.9rem}.results-table td,.results-table th{padding:10px 8px}}@media (max-width:480px){.container{padding:15px}.header h2{font-size:1.8rem}.search-section{padding:20px}.results-table{font-size:.8rem}.results-table td,.results-table th{padding:8px 6px}}@media (prefers-reduced-motion:reduce){*{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important}}.btn:focus,.form-control:focus{outline:2px solid #667eea;outline-offset:2px}@media (prefers-contrast:high){.container{background:rgba(255,255,255,.95);border:2px solid #000}.form-control{background:#fff;border:2px solid #000}}.export-section{margin-top:30px;display:none;animation:fadeInUp .8s ease-out}.export-section.show{display:block}.export-buttons{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}.export-btn{padding:12px 24px;border:none;border-radius:var(--border-radius-small);font-weight:600;font-size:.9rem;cursor:pointer;transition:var(--transition);position:relative;overflow:hidden;text-transform:uppercase;letter-spacing:.5px;display:flex;align-items:center;gap:8px;min-width:140px;justify-content:center}.export-btn-pdf{background:linear-gradient(135deg,#ff6b6b 0,#ee5a24 100%);color:#fff;box-shadow:0 4px 15px rgba(255,107,107,.3)}.export-btn-excel{background:linear-gradient(135deg,#2ed573 0,#1e90ff 100%);color:#fff;box-shadow:0 4px 15px rgba(46,213,115,.3)}.export-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.2)}.export-btn:active{transform:translateY(0)}.table-container{position:relative;overflow:hidden;border-radius:var(--border-radius-small);box-shadow:var(--shadow-medium)}.table-header{background:var(--primary-gradient);color:#fff;padding:20px;text-align:center;font-weight:600;font-size:1.1rem;text-transform:uppercase;letter-spacing:.5px}.table-stats{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:rgba(255,255,255,.9);border-bottom:1px solid rgba(0,0,0,.05);font-size:.9rem;color:#4a5568}.stats-item{display:flex;align-items:center;gap:8px}.stats-item i{color:#667eea}.loading-container{display:flex;flex-direction:column;align-items:center;gap:20px;padding:40px}.loading-spinner{width:50px;height:50px;border:4px solid rgba(102,126,234,.1);border-radius:50%;border-top-color:#667eea;animation:spin 1s linear infinite}.loading-text{color:#718096;font-size:1rem;text-align:center}.loading-dots{display:inline-block;animation:loadingDots 1.5s infinite}@keyframes loadingDots{0%,20%{content:"Loading"}40%{content:"Loading."}60%{content:"Loading.."}100%,80%{content:"Loading..."}}@media (max-width:768px){.export-buttons{flex-direction:column;align-items:stretch}.export-btn{width:100%;justify-content:center}.table-stats{flex-direction:column;gap:10px;text-align:center}.stats-item{justify-content:center}}@media (prefers-color-scheme:dark){:root{--glass-bg:rgba(0, 0, 0, 0.3);--glass-border:rgba(255, 255, 255, 0.1)}body{color:#e2e8f0}.form-control{background:rgba(45,55,72,.9);color:#e2e8f0;border-color:rgba(255,255,255,.2)}.form-control:focus{border-color:#667eea;background:#2d3748}.results-table{background:rgba(45,55,72,.95);color:#e2e8f0}.results-table td{border-bottom-color:rgba(255,255,255,.1)}.results-table tr:hover td{background:rgba(102,126,234,.1)}.input-log{background:rgba(45,55,72,.8);color:#a0aec0}.empty-state{color:#a0aec0}.empty-state h3{color:#e2e8f0}}@media print{body{background:#fff;color:#000}.container{background:#fff;box-shadow:none;border:1px solid #ccc}.export-section,.search-section{display:none}.results-table{background:#fff;color:#000}.results-table th{background:#f8f9fa;color:#000}}#columnDropdownBtn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;border:none;border-radius:10px;padding:12px 22px;font-size:1.08rem;font-weight:600;cursor:pointer;margin:10px 0 18px 0;box-shadow:0 2px 8px rgba(102,126,234,.1);transition:background .2s,transform .1s;position:relative;z-index:20}#columnDropdownBtn:active{transform:scale(.97)}#columnDropdown{display:none;position:absolute;left:0;top:100%;min-width:210px;max-width:92vw;background:rgba(255,255,255,.65);border-radius:16px;box-shadow:0 8px 32px rgba(102,126,234,.18);padding:14px 14px 8px 14px;margin-top:6px;z-index:100;flex-direction:column;gap:8px;animation:fadeInDropdown .18s;backdrop-filter:blur(18px) saturate(1.3);-webkit-backdrop-filter:blur(18px) saturate(1.3);border:1.5px solid rgba(120,120,180,.13)}@keyframes fadeInDropdown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}#columnDropdown.open{display:flex}#columnDropdown label{display:flex;align-items:center;gap:7px;font-weight:400;font-size:.98rem;margin:0 0 6px 0;cursor:pointer}#columnDropdown input[type=checkbox]{accent-color:#764ba2;width:18px;height:18px;margin:0 4px 0 0;cursor:pointer}#columnDropdown .dropdown-actions{display:flex;justify-content:flex-end;margin-top:4px}#columnDropdown .dropdown-close{background:#764ba2;color:#fff;border:none;border-radius:8px;padding:6px 16px;font-size:.98rem;cursor:pointer;margin-left:8px;box-shadow:0 2px 8px rgba(102,126,234,.1)}.search-within-container{display:none;margin:10px 0 0 0;text-align:center;animation:fadeIn .5s ease-out}.search-within-input{max-width:350px;width:90%;padding:12px 16px;border-radius:8px;border:1.5px solid #e2e8f0;font-size:1rem;margin:0 auto;background:rgba(255,255,255,.9);transition:var(--transition)}.search-within-input:focus{border-color:#667eea;box-shadow:0 0 0 4px rgba(102,126,234,.1);outline:0}.search-within-input::placeholder{color:#a0aec0}@media (max-width:768px){#columnDropdown{left:50%;top:60px;transform:translateX(-50%);width:95vw;max-width:350px;min-width:180px;max-height:45vh;overflow-y:auto;border-radius:12px;box-shadow:0 4px 18px rgba(102,126,234,.13);padding:14px 12px 10px 12px;margin-top:0;z-index:3000;background:rgba(255,255,255,.95);backdrop-filter:blur(10px) saturate(1.1);-webkit-backdrop-filter:blur(10px) saturate(1.1);border:1.5px solid rgba(120,120,180,.13);animation:fadeInDropdown .18s;display:none;flex-direction:column;gap:6px;box-sizing:border-box}#columnDropdown.open{display:flex}#columnDropdown label{font-size:1rem;color:#222;font-weight:500;margin:0 0 4px 0;gap:2px;line-height:1.3;letter-spacing:.01em;display:flex;align-items:center;white-space:normal;word-break:break-word}#columnDropdown input[type=checkbox]{width:18px!important;height:18px!important;min-height:unset!important;margin:0 1px 0 0;accent-color:#764ba2;vertical-align:middle;flex-shrink:0}#columnDropdown .dropdown-close{width:100%;font-size:1.05rem;padding:10px 0;margin:10px 0 0 0;border-radius:8px;background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;font-weight:600;letter-spacing:.5px}.search-within-input{max-width:300px;width:95%;padding:10px 14px;font-size:16px}}@media (prefers-color-scheme:dark){#columnDropdown{background:rgba(45,55,72,.95);border-color:rgba(255,255,255,.1)}#columnDropdown label{color:#e2e8f0}.search-within-input{background:rgba(45,55,72,.9);color:#e2e8f0;border-color:rgba(255,255,255,.2)}.search-within-input::placeholder{color:#a0aec0}.search-within-input:focus{background:#2d3748;border-color:#667eea}}.connection-status{position:fixed;top:0;left:0;right:0;z-index:2000;background:#f56565;color:#fff;text-align:center;font-weight:600;font-size:1.08rem;padding:10px 0;box-shadow:0 2px 12px #e53e3e33;letter-spacing:.5px;animation:fadeIn .2s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.custom-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(255,255,255,.7);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10002;opacity:0;animation:overlayFadeIn .35s cubic-bezier(.4,0,.2,1) forwards,overlayPulse .5s cubic-bezier(.4,0,.2,1);backdrop-filter:blur(8px) saturate(1.2)}@keyframes overlayFadeIn{from{opacity:0}to{opacity:1}}@keyframes overlayPulse{0%{box-shadow:0 0 0 0 #764ba244}70%{box-shadow:0 0 0 40px #764ba222}100%{box-shadow:0 0 0 0 #764ba200}}.loading{display:inline-block;width:48px;height:48px;border:5px solid rgba(118,75,162,.15);border-radius:50%;border-top:5px solid #764ba2;border-right:5px solid #667eea;border-bottom:5px solid #f093fb;animation:spin 1s linear infinite,glow 1.2s ease-in-out infinite alternate;box-shadow:0 0 18px 4px #764ba2aa}@keyframes spin{to{transform:rotate(360deg)}}@keyframes glow{0%{box-shadow:0 0 18px 4px #764ba2aa}100%{box-shadow:0 0 32px 10px #f093fbcc}}.loading-text{margin-top:24px;font-size:1.3rem;color:#764ba2;font-weight:600;letter-spacing:1px;text-shadow:0 2px 8px #fff8,0 1px 0 #fff;animation:loadingTextFade 1.2s infinite alternate}@keyframes loadingTextFade{0%{opacity:.7}100%{opacity:1}}.info-banner{margin:18px auto 18px auto;background:#f3e8ff;color:#764ba2;border-radius:10px;font-size:1.08rem;font-weight:500;box-shadow:0 1px 6px #764ba111;max-width:600px;text-align:center;letter-spacing:.1px;border:1.2px solid #e9d8fd;padding:12px 18px;display:flex;align-items:center;gap:10px;justify-content:center}.info-banner i{font-size:1.2em;color:#764ba2}@media (max-width:600px){.info-banner{font-size:.98rem;padding:10px 4vw;max-width:98vw}}</style>
  </head>
  <body>
<nav class=main-nav>
<a href=index.html class=nav-link title=Home><span class=nav-icon>🏠</span><span class=nav-label>Home</span></a>
<a href=pending.html class="nav-link active" title="Pending Order Forms"><span class=nav-icon>⏳</span><span class=nav-label>Pending</span></a>
<a href=paid.html class=nav-link title="Paid Payments"><span class=nav-icon>✅</span><span class=nav-label>Paid</span></a>
</nav>
<style>.main-nav{position:fixed;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;gap:18px;background:rgba(255,255,255,.85);box-shadow:0 2px 16px 0 #764ba222;z-index:1001;padding:10px 0 6px 0;backdrop-filter:blur(8px) saturate(1.2)}.nav-link{display:flex;align-items:center;gap:7px;font-size:1.08rem;font-weight:600;color:#764ba2;text-decoration:none;padding:7px 18px;border-radius:12px;transition:background .2s,color .2s,box-shadow .2s;position:relative}.nav-link .nav-icon{font-size:1.2em}.nav-link.active,.nav-link:hover{background:linear-gradient(90deg,#f3e8ff 0,#e9d8fd 100%);color:#4a5568;box-shadow:0 2px 8px #764ba222}@media (max-width:600px){.main-nav{gap:6px;padding:7px 0 3px 0}.nav-link{font-size:.98rem;padding:6px 10px;gap:4px}.nav-link .nav-label{display:none}}</style>
<div style=height:54px></div>
<div class=container>
<div class=header>
<h2><i class="fas fa-search"></i> Pending Order Lookup Portal</h2>
</div>
<div class=search-section>
<form class=search-form onsubmit=searchNow(event)>
<div class=form-group>
<label for=searchType>
<i class="fas fa-filter"></i> Search By
</label>
<select id=searchType class=form-control required>
<option value="" disabled selected>Select search option</option>
      <option value="Email Address">Email ID</option>
      <option value="Order ID">Order ID</option>
      <option value="Whatsapp Number">WhatsApp Number</option>
    </select>
</div>
<div class=form-group>
<label for=searchValue>
<i class="fas fa-search"></i> Search Value
</label>
<input id=searchValue class=form-control placeholder="Enter value to search..." required>
</div>
<button type=submit class="btn btn-primary" id=searchBtn>
<i class="fas fa-search"></i> Search
</button>
</form>
</div>
<div class=info-banner>
<i class="fas fa-info-circle"></i>
If your order is cancelled or has been updated incorrectly, please inform the admin to have it corrected.
</div>
<div class=status-section>
<div id=inputLog class=input-log style=display:none></div>
<div id=status class=status-message style=display:none></div>
</div>
<div id=searchWithinContainer class=search-within-container>
<input id=searchWithinInput class=search-within-input placeholder="Search within results..." oninput=debouncedSearchWithinResults()>
</div>
<div id=columnDropdownContainer style=position:relative;z-index:20;display:none>
<button id=columnDropdownBtn type=button onclick=toggleColumnDropdown(event)>
<span style=font-size:1.1em>☰</span> Show/Hide Columns
</button>
<div id=columnDropdown></div>
</div>
<div class=results-section>
<div id=results>
<div class=empty-state>
<i class="fas fa-search"></i>
<h3>Ready to Search</h3>
<p>Enter your search criteria above to find order information</p>
</div>
</div>
</div>
<div class=export-section id=exportSection>
<div class=export-buttons>
<button class="export-btn export-btn-pdf" onclick=exportToPDF() id=exportPdfBtn>
<i class="fas fa-file-pdf"></i>
Export PDF
</button>
<button class="export-btn export-btn-excel" onclick=exportToExcel() id=exportExcelBtn>
<i class="fas fa-file-excel"></i>
Export Excel
</button>
</div>
</div>
</div>
<div id=connectionStatus class=connection-status style=display:none>⚠️ Internet connection lost. Some features may not work.</div>
<style>.connection-status{position:fixed;top:0;left:0;right:0;z-index:2000;background:#f56565;color:#fff;text-align:center;font-weight:600;font-size:1.08rem;padding:10px 0;box-shadow:0 2px 12px #e53e3e33;letter-spacing:.5px;animation:fadeIn .2s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.custom-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(255,255,255,.7);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10002;opacity:0;animation:overlayFadeIn .35s cubic-bezier(.4,0,.2,1) forwards,overlayPulse .5s cubic-bezier(.4,0,.2,1);backdrop-filter:blur(8px) saturate(1.2)}@keyframes overlayFadeIn{from{opacity:0}to{opacity:1}}@keyframes overlayPulse{0%{box-shadow:0 0 0 0 #764ba244}70%{box-shadow:0 0 0 40px #764ba222}100%{box-shadow:0 0 0 0 #764ba200}}.loading{display:inline-block;width:48px;height:48px;border:5px solid rgba(118,75,162,.15);border-radius:50%;border-top:5px solid #764ba2;border-right:5px solid #667eea;border-bottom:5px solid #f093fb;animation:spin 1s linear infinite,glow 1.2s ease-in-out infinite alternate;box-shadow:0 0 18px 4px #764ba2aa}@keyframes spin{to{transform:rotate(360deg)}}@keyframes glow{0%{box-shadow:0 0 18px 4px #764ba2aa}100%{box-shadow:0 0 32px 10px #f093fbcc}}.loading-text{margin-top:24px;font-size:1.3rem;color:#764ba2;font-weight:600;letter-spacing:1px;text-shadow:0 2px 8px #fff8,0 1px 0 #fff;animation:loadingTextFade 1.2s infinite alternate}@keyframes loadingTextFade{0%{opacity:.7}100%{opacity:1}}</style>
<script>function updateConnectionStatus(){const n=document.getElementById("connectionStatus");navigator.onLine?n.style.display="none":n.style.display="block"}function navNavigate(n){let t=document.createElement("div");t.className="custom-overlay",t.innerHTML='<div class="loading"></div><div class="loading-text">Loading...</div>',document.body.appendChild(t),setTimeout((()=>{window.location.href=n}),700)}window.addEventListener("online",updateConnectionStatus),window.addEventListener("offline",updateConnectionStatus),document.addEventListener("DOMContentLoaded",updateConnectionStatus),document.querySelectorAll(".navbar-link").forEach((n=>{n.addEventListener("click",(function(n){n.preventDefault();navNavigate(this.getAttribute("href"))}))}))</script>
<script>let currentResults=[],searchResultsOriginal=[],searchResultsView=[],hiddenColumns=[],searchWithinTimeout=null;function searchNow(e){e.preventDefault();const t=document.getElementById("searchType").value,n=document.getElementById("searchValue").value.trim(),s=(document.getElementById("status"),document.getElementById("inputLog"),document.getElementById("results")),o=document.getElementById("searchBtn"),l=document.getElementById("exportSection"),i=document.getElementById("searchWithinContainer"),a=document.getElementById("columnDropdownContainer");if(!n)return void showStatus("Please enter a search value.","error");o.innerHTML='<span class="loading"></span>Searching...',o.disabled=!0,showStatus("Searching...","info"),showLog(`Searching for: "${n}"`),s.innerHTML=createLoadingSkeleton(),l.classList.remove("show"),i.style.display="none",a.style.display="none";const r=`https://script.google.com/macros/s/AKfycbz0TH02yxj15e9oLTYFNAzDgiDyY2f64tmIDZjeZObFBL_9ytNQuQX5r4ROpSaf6Ojf/exec?type=${encodeURIComponent(t)}&value=${encodeURIComponent(n)}`;fetch(r).then((e=>e.json())).then((e=>{if(!e.results||0===e.results.length)return showStatus("No matching records found.","warning"),showEmptyState(),currentResults=[],searchResultsOriginal=[],void(searchResultsView=[]);currentResults=e.results,searchResultsOriginal=e.results,searchResultsView=[...e.results],hiddenColumns=[],showStatus(`Found ${e.results.length} result(s)`,"info"),displayResults(e.results),l.classList.add("show"),e.results.length>0&&(i.style.display="block",a.style.display="block",renderColumnToggles(Object.keys(e.results[0])))})).catch((e=>{console.error("Error:",e),showStatus("Error fetching data. Please try again.","error"),showEmptyState(),currentResults=[],searchResultsOriginal=[],searchResultsView=[]})).finally((()=>{o.innerHTML='<i class="fas fa-search"></i> Search',o.disabled=!1}))}function showStatus(e,t){const n=document.getElementById("status");n.textContent=e,n.className=`status-message status-${t}`,n.style.display="block"}function showLog(e){const t=document.getElementById("inputLog");t.textContent=e,t.style.display="block"}function createLoadingSkeleton(){return'\n                <div class="loading-container">\n                    <div class="loading-spinner"></div>\n                    <div class="loading-text">\n                        <span class="loading-dots">Loading</span>\n                    </div>\n                </div>\n            '}function showEmptyState(){document.getElementById("results").innerHTML='\n                <div class="empty-state">\n                    <i class="fas fa-inbox"></i>\n                    <h3>No Results Found</h3>\n                    <p>Try adjusting your search criteria or check the spelling</p>\n                </div>\n            '}function displayResults(e){const t=document.getElementById("results");if(!e||0===e.length)return void showEmptyState();const n=Object.keys(e[0]).filter((e=>!hiddenColumns.includes(e)));let s=`\n                <div class="table-container">\n                    <div class="table-header">\n                        <i class="fas fa-table"></i> Search Results\n                    </div>\n                    <div class="table-stats">\n                        <div class="stats-item">\n                            <i class="fas fa-list"></i>\n                            <span>Total Records: ${e.length}</span>\n                        </div>\n                        <div class="stats-item">\n                            <i class="fas fa-clock"></i>\n                            <span>Search Time: ${(new Date).toLocaleTimeString()}</span>\n                        </div>\n                    </div>\n                    <div style="overflow-x: auto;">\n                        <table class="results-table">\n                            <thead>\n                                <tr>\n                                    ${n.map((e=>`<th>${e}</th>`)).join("")}\n                                </tr>\n                            </thead>\n                            <tbody>\n            `;e.forEach((e=>{s+="<tr>",n.forEach((t=>{let n=e[t]||"";"Whatsapp Number"===t&&n&&(n=maskPhoneNumber(n)),"Payment Date"===t&&n&&(n=formatDate(n)),s+=`<td>${n}</td>`})),s+="</tr>"})),s+="\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            ",t.innerHTML=s}function maskPhoneNumber(e){const t=String(e);return t.length<=6?t.replace(/./g,"*"):t.slice(0,3)+"****"+t.slice(-3)}function formatDate(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}}function exportToPDF(){if(!currentResults||0===currentResults.length)return void alert("No data to export!");const e=document.getElementById("exportPdfBtn");e.innerHTML='<span class="loading"></span>Generating PDF...',e.disabled=!0;const t=Object.keys(currentResults[0]).filter((e=>!hiddenColumns.includes(e))),n=currentResults.map((e=>t.map((t=>e[t]||"")))),{jsPDF:s}=window.jspdf,o=new s;o.autoTable({head:[t],body:n,styles:{fontSize:9},headStyles:{fillColor:[102,126,234]},margin:{top:18},didDrawPage:function(e){o.setFontSize(14),o.text("Pending Orders Export",e.settings.margin.left,12)}}),o.save("pending_orders.pdf"),e.innerHTML='<i class="fas fa-file-pdf"></i> Export PDF',e.disabled=!1}function exportToExcel(){if(!currentResults||0===currentResults.length)return void alert("No data to export!");const e=document.getElementById("exportExcelBtn");e.innerHTML='<span class="loading"></span>Generating Excel...',e.disabled=!0;const t=Object.keys(currentResults[0]).filter((e=>!hiddenColumns.includes(e))),n=currentResults.map((e=>{const n={};return t.forEach((t=>{n[t]=e[t]||""})),n})),s=XLSX.utils.json_to_sheet(n),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,s,"Pending Orders"),XLSX.writeFile(o,"pending_orders.xlsx"),e.innerHTML='<i class="fas fa-file-excel"></i> Export Excel',e.disabled=!1}function debouncedSearchWithinResults(){searchWithinTimeout&&clearTimeout(searchWithinTimeout),searchWithinTimeout=setTimeout(searchWithinResults,300)}function searchWithinResults(){const e=document.getElementById("searchWithinInput").value.trim().toLowerCase();searchResultsOriginal&&searchResultsOriginal.length>0&&(searchResultsView=e?searchResultsOriginal.filter((t=>Object.values(t).some((t=>String(t).toLowerCase().includes(e))))):[...searchResultsOriginal],displayResults(searchResultsView))}function renderColumnToggles(e){const t=document.getElementById("columnDropdown");e&&e.length>0?t.innerHTML=e.map((e=>`\n                    <label>\n                        <input type="checkbox" value="${e}" ${hiddenColumns.includes(e)?"":"checked"} onchange="toggleColumnVisibility(this)">\n                        ${e}\n                    </label>\n                `)).join("")+'\n                    <div class="dropdown-actions">\n                        <button class="dropdown-close" type="button" onclick="closeColumnDropdown()">Done</button>\n                    </div>\n                ':t.innerHTML=""}function toggleColumnDropdown(e){e.stopPropagation();const t=document.getElementById("columnDropdown");t.classList.toggle("open"),t.classList.contains("open")?document.addEventListener("click",closeDropdownOnOutside,{capture:!0}):document.removeEventListener("click",closeDropdownOnOutside,{capture:!0})}function closeDropdownOnOutside(e){const t=document.getElementById("columnDropdown"),n=document.getElementById("columnDropdownBtn");t.contains(e.target)||n.contains(e.target)||(t.classList.remove("open"),document.removeEventListener("click",closeDropdownOnOutside,{capture:!0}))}function closeColumnDropdown(){document.getElementById("columnDropdown").classList.remove("open"),document.removeEventListener("click",closeDropdownOnOutside,{capture:!0})}function toggleColumnVisibility(e){const t=e.value;e.checked?hiddenColumns=hiddenColumns.filter((e=>e!==t)):hiddenColumns.includes(t)||hiddenColumns.push(t),displayResults(searchResultsView)}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("searchValue").focus(),document.getElementById("searchValue").addEventListener("keypress",(function(e){"Enter"===e.key&&searchNow(e)})),document.getElementById("searchValue").addEventListener("input",(function(){const e=this.value.trim();document.getElementById("searchBtn").disabled=!e}))}))</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2PRMZL2Z5X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2PRMZL2Z5X",{send_page_view:!0,page_title:"Pending Order Lookup Portal",page_location:window.location.href,custom_map:{dimension1:"user_type",dimension2:"search_type",dimension3:"results_count",dimension4:"export_action",dimension5:"device_type",dimension6:"session_duration",dimension7:"error_type",dimension8:"feature_usage"},allow_enhanced_conversions:!0,engagement_time_msec:1e4,send_page_view_on_load:!0,debug_mode:!1});const Analytics={trackSearch:function(e,t,n){gtag("event","search",{event_category:"Order Lookup",event_label:e,value:n,custom_parameters:{search_type:e,search_value_length:t.length,results_count:n,user_type:this.getUserType(),device_type:this.getDeviceType()}})},trackExport:function(e,t){gtag("event","export",{event_category:"Data Export",event_label:e,value:t,custom_parameters:{export_type:e,results_count:t,user_type:this.getUserType()}})},trackColumnToggle:function(e,t){gtag("event","column_toggle",{event_category:"Table Management",event_label:e,value:t?1:0,custom_parameters:{column_name:e,action:t?"show":"hide",user_type:this.getUserType()}})},trackSearchWithin:function(e,t,n){gtag("event","search_within",{event_category:"Data Filtering",event_label:e,value:t,custom_parameters:{search_term:e,filtered_count:t,total_count:n,filter_ratio:(t/n*100).toFixed(2)}})},trackError:function(e,t){gtag("event","error",{event_category:"System Error",event_label:e,custom_parameters:{error_type:e,error_message:t,user_type:this.getUserType(),device_type:this.getDeviceType(),page_url:window.location.href}})},trackEngagement:function(e,t){gtag("event","user_engagement",{event_category:"User Interaction",event_label:e,custom_parameters:{action:e,details:t,user_type:this.getUserType(),session_duration:this.getSessionDuration(),page_load_time:this.getPageLoadTime()}})},trackPerformance:function(e,t){gtag("event","performance",{event_category:"Performance",event_label:e,value:t,custom_parameters:{metric:e,value:t,user_type:this.getUserType(),device_type:this.getDeviceType()}})},trackFeatureUsage:function(e,t){gtag("event","feature_usage",{event_category:"Feature Analytics",event_label:e,custom_parameters:{feature:e,usage_type:t,user_type:this.getUserType(),device_type:this.getDeviceType()}})},getUserType:function(){const e=sessionStorage.getItem("session_count")||0;return e>5?"returning_user":e>1?"active_user":"new_user"},getDeviceType:function(){const e=navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)?"mobile":/iPad/i.test(e)?"tablet":"desktop"},getSessionDuration:function(){const e=sessionStorage.getItem("session_start")||Date.now();return Math.floor((Date.now()-e)/1e3)},getPageLoadTime:function(){if(window.performance&&window.performance.timing){return window.performance.timing.loadEventEnd-window.performance.timing.navigationStart}return 0},initSession:function(){const e=parseInt(sessionStorage.getItem("session_count")||0);sessionStorage.setItem("session_count",e+1),sessionStorage.setItem("session_start",Date.now()),gtag("event","session_start",{event_category:"User Session",custom_parameters:{session_count:e+1,user_type:this.getUserType(),device_type:this.getDeviceType()}})}},originalSearchNow=window.searchNow;window.searchNow=function(e){e.preventDefault();const t=document.getElementById("searchType").value,n=document.getElementById("searchValue").value.trim();Analytics.trackEngagement("search_attempt",{type:t,value_length:n.length}),originalSearchNow(e)};const originalDisplayResults=window.displayResults;window.displayResults=function(e){Analytics.trackEngagement("results_displayed",{count:e.length}),originalDisplayResults(e)};const originalExportToPDF=window.exportToPDF;window.exportToPDF=function(){Analytics.trackExport("pdf",currentResults.length),originalExportToPDF()};const originalExportToExcel=window.exportToExcel;window.exportToExcel=function(){Analytics.trackExport("excel",currentResults.length),originalExportToExcel()};const originalToggleColumnVisibility=window.toggleColumnVisibility;window.toggleColumnVisibility=function(e){const t=e.value,n=e.checked;Analytics.trackColumnToggle(t,n),originalToggleColumnVisibility(e)};const originalSearchWithinResults=window.searchWithinResults;let engagementTimer;function resetEngagementTimer(){clearTimeout(engagementTimer),engagementTimer=setTimeout((()=>{Analytics.trackEngagement("user_inactive",{duration:300})}),3e5)}window.searchWithinResults=function(){const e=document.getElementById("searchWithinInput").value.trim(),t=searchResultsView.length,n=searchResultsOriginal.length;e&&Analytics.trackSearchWithin(e,t,n),originalSearchWithinResults()},window.addEventListener("load",(function(){if(window.performance&&window.performance.timing){const e=window.performance.timing.loadEventEnd-window.performance.timing.navigationStart;Analytics.trackPerformance("page_load_time",e)}"PerformanceObserver"in window&&(new PerformanceObserver((e=>{const t=e.getEntries(),n=t[t.length-1];Analytics.trackPerformance("lcp",n.startTime)})).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver((e=>{e.getEntries().forEach((e=>{Analytics.trackPerformance("fid",e.processingStart-e.startTime)}))})).observe({entryTypes:["first-input"]}),new PerformanceObserver((e=>{let t=0;e.getEntries().forEach((e=>{e.hadRecentInput||(t+=e.value)})),Analytics.trackPerformance("cls",t)})).observe({entryTypes:["layout-shift"]}))})),window.addEventListener("error",(function(e){Analytics.trackError("javascript_error",e.message)})),window.addEventListener("unhandledrejection",(function(e){Analytics.trackError("promise_rejection",e.reason)})),["click","scroll","keypress","mousemove"].forEach((e=>{document.addEventListener(e,resetEngagementTimer,{passive:!0})})),document.addEventListener("DOMContentLoaded",(function(){Analytics.initSession(),gtag("event","page_view",{page_title:"Pending Order Lookup Portal",page_location:window.location.href,custom_parameters:{user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}}),Analytics.trackFeatureUsage("page_load","initial")}));const originalSearchSuccess=function(e){e.results&&e.results.length>0?Analytics.trackSearch(document.getElementById("searchType").value,document.getElementById("searchValue").value,e.results.length):Analytics.trackError("no_results","Search returned no results")},originalSearchError=function(e){Analytics.trackError("search_error",e.message||"Unknown search error")};gtag("config","G-2PRMZL2Z5X",{allow_enhanced_conversions:!0,user_properties:{user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()},custom_parameters:{page_type:"order_lookup",feature_set:"enhanced"}});const AdvancedAnalytics={trackConversion:function(e,t,n="INR"){gtag("event","conversion",{send_to:"G-2PRMZL2Z5X",value:t,currency:n,transaction_id:this.generateTransactionId(),custom_parameters:{conversion_type:e,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})},trackExperiment:function(e,t,n){gtag("event","experiment_impression",{experiment_id:e,variant:t,success:n,custom_parameters:{user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})},trackUserJourney:function(e,t){gtag("event","user_journey",{event_category:"User Flow",event_label:e,custom_parameters:{step:e,details:t,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType(),session_duration:Analytics.getSessionDuration(),page_url:window.location.href}})},trackRealTimeBehavior:function(e,t,n){gtag("event","real_time_behavior",{event_category:"User Behavior",event_label:e,custom_parameters:{action:e,element:t,value:n,timestamp:Date.now(),user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})},trackDetailedError:function(e,t,n){gtag("event","detailed_error",{event_category:"System Error",event_label:e,custom_parameters:{error_type:e,error_message:t,context:n,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType(),page_url:window.location.href,user_agent:navigator.userAgent,timestamp:Date.now()}})},trackPerformanceWithThresholds:function(e,t,n){gtag("event","performance_threshold",{event_category:"Performance",event_label:e,value:t,custom_parameters:{metric:e,value:t,threshold:n,status:t<=n?"good":"poor",user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})},trackUserSatisfaction:function(e,t){gtag("event","user_satisfaction",{event_category:"User Experience",event_label:e,value:e,custom_parameters:{satisfaction_level:e,reason:t,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType(),session_duration:Analytics.getSessionDuration()}})},trackFeatureAdoption:function(e,t){gtag("event","feature_adoption",{event_category:"Feature Analytics",event_label:e,custom_parameters:{feature:e,adoption_type:t,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType(),session_count:sessionStorage.getItem("session_count")||0}})},generateTransactionId:function(){return"txn_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)},trackScrollDepth:function(){let e=0,t=!1;window.addEventListener("scroll",(function(){t||(t=!0,setTimeout((function(){const n=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);n>e&&(e=n,e%25==0&&gtag("event","scroll_depth",{event_category:"User Engagement",event_label:e+"%",value:e,custom_parameters:{scroll_depth:e,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})),t=!1}),100))}))},trackTimeOnPage:function(){const e=Date.now();window.addEventListener("beforeunload",(function(){const t=Math.round((Date.now()-e)/1e3);gtag("event","time_on_page",{event_category:"User Engagement",value:t,custom_parameters:{time_on_page:t,user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})}))},trackFormInteractions:function(){document.querySelectorAll("form").forEach((e=>{e.addEventListener("submit",(function(){gtag("event","form_submit",{event_category:"Form Interaction",event_label:e.id||"unknown_form",custom_parameters:{form_id:e.id||"unknown_form",user_type:Analytics.getUserType(),device_type:Analytics.getDeviceType()}})}))}))}};document.addEventListener("DOMContentLoaded",(function(){AdvancedAnalytics.trackScrollDepth(),AdvancedAnalytics.trackTimeOnPage(),AdvancedAnalytics.trackFormInteractions(),AdvancedAnalytics.trackUserJourney("page_load",{referrer:document.referrer,landing_page:window.location.href})}));const enhancedSearchNow=function(e){e.preventDefault();const t=document.getElementById("searchType").value,n=document.getElementById("searchValue").value.trim();AdvancedAnalytics.trackRealTimeBehavior("search_attempt","search_form",{type:t,value_length:n.length,has_value:n.length>0}),AdvancedAnalytics.trackUserJourney("search_initiated",{search_type:t,value_length:n.length}),originalSearchNow(e)};window.searchNow=enhancedSearchNow;const enhancedDisplayResults=function(e){e&&e.length>0?(AdvancedAnalytics.trackConversion("search_success",e.length),AdvancedAnalytics.trackUserJourney("results_found",{count:e.length,search_type:document.getElementById("searchType").value})):AdvancedAnalytics.trackUserJourney("no_results",{search_type:document.getElementById("searchType").value}),originalDisplayResults(e)};window.displayResults=enhancedDisplayResults;const enhancedExportToPDF=function(){AdvancedAnalytics.trackConversion("export_pdf",currentResults.length),AdvancedAnalytics.trackFeatureAdoption("pdf_export","used"),originalExportToPDF()},enhancedExportToExcel=function(){AdvancedAnalytics.trackConversion("export_excel",currentResults.length),AdvancedAnalytics.trackFeatureAdoption("excel_export","used"),originalExportToExcel()};function trackSearchSatisfaction(e,t){const n=e?5:2;AdvancedAnalytics.trackUserSatisfaction(n,t)}window.exportToPDF=enhancedExportToPDF,window.exportToExcel=enhancedExportToExcel,window.addEventListener("load",(function(){if(window.performance&&window.performance.timing){const e=window.performance.timing.loadEventEnd-window.performance.timing.navigationStart;AdvancedAnalytics.trackPerformanceWithThresholds("page_load_time",e,3e3)}"PerformanceObserver"in window&&(new PerformanceObserver((e=>{const t=e.getEntries(),n=t[t.length-1];AdvancedAnalytics.trackPerformanceWithThresholds("lcp",n.startTime,2500)})).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver((e=>{e.getEntries().forEach((e=>{const t=e.processingStart-e.startTime;AdvancedAnalytics.trackPerformanceWithThresholds("fid",t,100)}))})).observe({entryTypes:["first-input"]}),new PerformanceObserver((e=>{let t=0;e.getEntries().forEach((e=>{e.hadRecentInput||(t+=e.value)})),AdvancedAnalytics.trackPerformanceWithThresholds("cls",t,.1)})).observe({entryTypes:["layout-shift"]}))})),window.addEventListener("error",(function(e){AdvancedAnalytics.trackDetailedError("javascript_error",e.message,{filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error})})),window.addEventListener("unhandledrejection",(function(e){AdvancedAnalytics.trackDetailedError("promise_rejection",e.reason,{promise:e.promise})})),window.trackSearchSatisfaction=trackSearchSatisfaction</script>
<script>"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("service-worker.js")}))</script>
<div id=updateBanner class=update-banner style=display:none>
<span>🔄 A new version is available.</span>
<button onclick=location.reload() class=update-btn>Refresh</button>
</div>
<style>.update-banner{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#764ba2;color:#fff;padding:12px 24px;border-radius:999px;box-shadow:0 4px 18px #764ba244;font-size:1.08rem;font-weight:500;z-index:3000;display:flex;align-items:center;gap:18px;animation:fadeIn .3s}.update-btn{background:#fff;color:#764ba2;border:none;border-radius:999px;padding:7px 18px;font-size:1rem;font-weight:600;cursor:pointer;margin-left:10px;transition:background .2s,color .2s}.update-btn:hover{background:#f3e8ff;color:#5a189a}</style>
<script>"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(e){e.data&&"NEW_VERSION_AVAILABLE"===e.data.type&&(document.getElementById("updateBanner").style.display="flex")}))</script>
  </body>
</html>