<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paid Payments</title>
<!-- Favicons for all devices -->
<link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
<link rel="manifest" href="favicon_io/site.webmanifest">
<link rel="icon" type="image/png" sizes="192x192" href="favicon_io/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="favicon_io/android-chrome-512x512.png">
<link rel="shortcut icon" href="favicon_io/favicon.ico">
<base target=_top>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<script src=https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js></script>
<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;padding:30px;background:linear-gradient(135deg,#667eea 0,#764ba2 50%,#f093fb 100%);min-height:100vh;color:#333;position:relative}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');pointer-events:none;z-index:-1}.container{max-width:1200px;margin:0 auto;background:rgba(255,255,255,.95);border-radius:20px;padding:40px;box-shadow:0 25px 50px rgba(0,0,0,.15);backdrop-filter:blur(15px);animation:slideInUp .8s ease-out;border:1px solid rgba(255,255,255,.2)}@keyframes slideInUp{from{opacity:0;transform:translateY(50px)}to{opacity:1;transform:translateY(0)}}h2{text-align:center;color:#4a5568;font-size:2.5rem;margin-bottom:30px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,.1);animation:fadeInDown 1s ease-out}@keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}.search-container{display:flex;gap:15px;align-items:center;justify-content:center;flex-wrap:wrap;margin-bottom:30px;animation:fadeIn 1.2s ease-out}@keyframes fadeIn{from{opacity:0}to{opacity:1}}label{font-weight:600;color:#4a5568;font-size:1.1rem;display:inline-block;transition:all .3s ease}label:hover{color:#667eea;transform:translateY(-2px)}button,input,select{padding:12px 20px;border:2px solid #e2e8f0;border-radius:12px;font-size:1rem;transition:all .3s ease;outline:0}select{position:relative;cursor:pointer;transition:all .3s cubic-bezier(.4, 0, .2, 1);background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:12px 20px;font-size:1rem;outline:0;min-width:150px;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:18px;padding-right:45px;box-shadow:0 2px 4px rgba(0,0,0,.05)}select:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 8px 25px rgba(102,126,234,.15);background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")}select:focus{border-color:#667eea;box-shadow:0 0 0 4px rgba(102,126,234,.1);transform:translateY(-2px);background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")}select:active{transform:translateY(0);box-shadow:0 4px 15px rgba(102,126,234,.2)}body.dark-theme select{background:#2d3748!important;border-color:#4a5568;color:#e2e8f0;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e2e8f0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")!important;background-repeat:no-repeat!important;background-position:right 12px center!important;background-size:18px!important;box-shadow:0 2px 4px rgba(0,0,0,.2);-webkit-appearance:none!important;-moz-appearance:none!important;appearance:none!important}body.dark-theme select:hover{border-color:#667eea;background-color:#374151!important;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")!important;background-repeat:no-repeat!important;background-position:right 12px center!important;background-size:18px!important;box-shadow:0 8px 25px rgba(102,126,234,.2)}body.dark-theme select:focus{background-color:#374151!important;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")!important;background-repeat:no-repeat!important;background-position:right 12px center!important;background-size:18px!important;box-shadow:0 0 0 4px rgba(102,126,234,.2)}select option{background:#fff;color:#333;padding:12px 16px;font-size:1rem;border:none;outline:0;transition:background-color .2s ease}select option:hover{background:#f7fafc}select option:checked{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff}body.dark-theme select option{background:#2d3748;color:#e2e8f0;border:none}body.dark-theme select option:hover{background:#374151}body.dark-theme select option:checked{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff}@media (max-width:768px){select{padding:15px 20px;font-size:16px;background-size:20px;background-position:right 15px center;padding-right:50px}body.dark-theme select{background-size:20px!important;background-position:right 15px center!important;padding-right:50px}select option{padding:15px 20px;font-size:16px}}@supports (-moz-appearance:none){select{background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:18px;padding-right:45px}body.dark-theme select{background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e2e8f0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")!important}}@supports (-webkit-appearance:none) and (not (overflow:-webkit-marquee)){select{background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:18px;padding-right:45px}body.dark-theme select{background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e2e8f0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e")!important}}input{min-width:250px;background:#fff}input:focus,select:focus{border-color:#667eea;box-shadow:0 0 0 4px rgba(102,126,234,.15);transform:translateY(-3px)}button{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff;border:none;cursor:pointer;font-weight:600;min-width:120px;position:relative;overflow:hidden;transition:all .3s cubic-bezier(.4, 0, .2, 1)}button:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 15px 35px rgba(102,126,234,.4)}button:active{transform:translateY(-1px) scale(1.02)}button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}button:hover::before{left:100%}#inputLog{font-style:italic;color:#718096;margin:15px 0;padding:10px 15px;background:#f7fafc;border-radius:8px;border-left:4px solid #667eea;animation:slideInLeft .6s ease-out}@keyframes slideInLeft{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}#status{margin:15px 0;font-weight:600;padding:15px 25px;border-radius:15px;text-align:center;animation:pulse 2s infinite;position:relative;overflow:hidden}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}#status::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .8s}#status:hover::before{left:100%}#status:empty{display:none}#results{margin-top:30px;animation:fadeInUp .8s ease-out;position:relative}#results::before{content:'';position:absolute;top:-10px;left:50%;transform:translateX(-50%);width:50px;height:3px;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);border-radius:2px;animation:expandWidth .6s ease-out}@keyframes expandWidth{from{width:0}to{width:50px}}@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}table{width:100%;border-collapse:collapse;background:#fff;border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.1);animation:scaleIn .6s ease-out;display:block;max-height:60vh;overflow-y:auto}th{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff;padding:15px 10px;text-align:left;font-weight:600;font-size:1rem;text-transform:uppercase;letter-spacing:.5px;position:sticky;top:0;z-index:2;box-shadow:0 2px 8px rgba(102,126,234,.12)}.mobile-table-wrapper th{position:sticky;top:0;z-index:2;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);box-shadow:0 2px 8px rgba(102,126,234,.12)}body.dark-theme .mobile-table-wrapper th,body.dark-theme th{background:linear-gradient(135deg,#2d3748 0,#4a5568 100%)!important;color:#e2e8f0;box-shadow:0 2px 8px rgba(0,0,0,.25)}td{padding:15px 12px;border-bottom:1px solid #e2e8f0;transition:all .3s ease;position:relative}td::before{content:'';position:absolute;left:0;top:0;width:3px;height:100%;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);transform:scaleY(0);transition:transform .3s ease}tr:hover td::before{transform:scaleY(1)}tr:last-child td{border-bottom:none}.loading{display:inline-block;width:32px;height:32px;border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@media (max-width:768px){.container{padding:20px;margin:10px}.search-container{flex-direction:column;align-items:stretch}button,input,select{width:100%;margin-bottom:10px}h2{font-size:2rem}table{font-size:.9rem}td,th{padding:8px 5px}}.success{background:linear-gradient(135deg,#48bb78 0,#38a169 100%);color:#fff}.error{background:linear-gradient(135deg,#f56565 0,#e53e3e 100%);color:#fff}.info{background:linear-gradient(135deg,#4299e1 0,#3182ce 100%);color:#fff}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid rgba(102,126,234,.1)}.header h2{margin:0;flex:1}.theme-toggle{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);border:none;border-radius:50%;width:60px;height:60px;cursor:pointer;position:relative;overflow:hidden;transition:all .3s cubic-bezier(.4, 0, .2, 1);box-shadow:0 8px 25px rgba(102,126,234,.3)}.theme-toggle:hover{transform:translateY(-3px) scale(1.1);box-shadow:0 15px 35px rgba(102,126,234,.4)}.theme-toggle:active{transform:translateY(-1px) scale(1.05)}.logo-container{width:100%;height:100%;display:flex;align-items:center;justify-content:center;position:relative}.logo-icon{width:30px;height:30px;position:relative;transition:all .5s cubic-bezier(.4, 0, .2, 1)}.sun-rays{position:absolute;width:100%;height:100%;border-radius:50%;background:gold;box-shadow:0 0 20px rgba(255,215,0,.6);transition:all .5s cubic-bezier(.4, 0, .2, 1)}.sun-rays::before{content:'';position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:4px;height:8px;background:gold;border-radius:2px;box-shadow:0 20px 0 gold,0 40px 0 gold,8px 10px 0 gold,16px 10px 0 gold,-8px 10px 0 gold,-16px 10px 0 gold,8px 30px 0 gold,16px 30px 0 gold,-8px 30px 0 gold,-16px 30px 0 gold}.moon-crescent{position:absolute;width:100%;height:100%;border-radius:50%;background:0 0;box-shadow:inset -4px 0 0 #fff;opacity:0;transform:rotate(90deg) scale(.8);transition:all .5s cubic-bezier(.4, 0, .2, 1)}body.dark-theme{background:linear-gradient(135deg,#1a1a2e 0,#16213e 50%,#0f3460 100%);color:#e2e8f0}body.dark-theme .container{background:rgba(26,32,44,.95);border:1px solid rgba(255,255,255,.1);box-shadow:0 25px 50px rgba(0,0,0,.3)}body.dark-theme h2{color:#e2e8f0;text-shadow:2px 2px 4px rgba(0,0,0,.3)}body.dark-theme label{color:#cbd5e0}body.dark-theme label:hover{color:#667eea}body.dark-theme input{background:#2d3748;border-color:#4a5568;color:#e2e8f0}body.dark-theme input:hover{border-color:#667eea;background:#374151}body.dark-theme input:focus{border-color:#667eea;background:#374151;box-shadow:0 0 0 4px rgba(102,126,234,.2)}body.dark-theme #inputLog{background:#2d3748;color:#a0aec0;border-left-color:#667eea}body.dark-theme table{background:#2d3748;box-shadow:0 10px 30px rgba(0,0,0,.3)}body.dark-theme th{background:linear-gradient(135deg,#2d3748 0,#4a5568 100%);color:#e2e8f0}body.dark-theme td{border-bottom-color:#4a5568;color:#e2e8f0}body.dark-theme tr:hover td{background-color:#374151}body.dark-theme tr:hover td::before{background:linear-gradient(135deg,#667eea 0,#764ba2 100%)}body.dark-theme .sun-rays{opacity:0;transform:scale(.5) rotate(180deg)}body.dark-theme .moon-crescent{opacity:1;transform:rotate(90deg) scale(1);box-shadow:inset -4px 0 0 #fff}body.dark-theme .theme-toggle{background:linear-gradient(135deg,#4a5568 0,#2d3748 100%);box-shadow:0 8px 25px rgba(0,0,0,.3)}body.dark-theme .theme-toggle:hover{box-shadow:0 15px 35px rgba(0,0,0,.4)}body,body *{transition:background-color .3s ease,color .3s ease,border-color .3s ease,box-shadow .3s ease}@keyframes rotate{from{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes pulse-glow{0%,100%{box-shadow:0 0 20px rgba(255,215,0,.6)}50%{box-shadow:0 0 30px rgba(255,215,0,.8)}}.sun-rays{animation:pulse-glow 2s ease-in-out infinite}@media (max-width:768px){.header{flex-direction:column;gap:20px;text-align:center}.theme-toggle{width:50px;height:50px}.logo-icon{width:25px;height:25px}}@media (max-width:768px){body{padding:15px 10px;font-size:14px}.container{padding:20px 15px;margin:5px;border-radius:15px}.header{flex-direction:column;gap:15px;text-align:center;margin-bottom:20px;padding-bottom:15px}.header h2{font-size:1.8rem;margin:0;line-height:1.2}.theme-toggle{width:50px;height:50px;align-self:center}.logo-icon{width:22px;height:22px}.search-container{flex-direction:column;align-items:stretch;gap:12px;margin-bottom:20px}.search-container label{font-size:1rem;margin-bottom:5px;display:block}.search-container button,.search-container input,.search-container select{width:100%;padding:15px 20px;font-size:16px;border-radius:10px;margin-bottom:0}.search-container button{margin-top:5px;min-height:50px}.export-container{flex-direction:column;gap:10px;margin:15px 0}.export-btn{width:100%;padding:15px 20px;min-height:50px;font-size:16px}#inputLog{margin:10px 0;padding:12px 15px;font-size:14px}#status{margin:10px 0;padding:15px 20px;font-size:14px;border-radius:10px}#results{margin-top:20px;overflow-x:auto}table{font-size:12px;min-width:600px}td,th{padding:8px 6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px}button,input,select{min-height:44px;touch-action:manipulation}button:focus,input:focus,select:focus{outline:0;box-shadow:0 0 0 3px rgba(102,126,234,.3)}.container{animation:slideInUpMobile .6s ease-out}@keyframes slideInUpMobile{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.loading{width:18px;height:18px}.export-btn.loading::after{width:18px;height:18px}}@media (max-width:480px){body{padding:10px 5px;font-size:13px}.container{padding:15px 10px;margin:2px}.header h2{font-size:1.5rem}.search-container button,.search-container input,.search-container select{padding:12px 15px;font-size:16px}.export-btn{padding:12px 15px;font-size:14px}table{font-size:11px}td,th{padding:6px 4px;max-width:100px}#inputLog,#status{padding:10px 12px;font-size:13px}}@media (max-width:768px) and (orientation:landscape){.header{flex-direction:row;justify-content:space-between;align-items:center;gap:10px}.header h2{font-size:1.4rem;margin:0}.search-container{flex-direction:row;flex-wrap:wrap;gap:10px}.search-container label{display:none}.search-container select{width:auto;min-width:120px}.search-container input{flex:1;min-width:150px}.search-container button{width:auto;min-width:100px}.export-container{flex-direction:row;justify-content:center}.export-btn{width:auto;min-width:120px}}@media (min-width:769px) and (max-width:1024px){body{padding:25px 20px}.container{padding:30px 25px}.search-container{gap:15px}.search-container input,.search-container select{min-width:200px}.export-container{gap:20px}.export-btn{min-width:160px}}@media (-webkit-min-device-pixel-ratio:2),(min-resolution:192dpi){.export-btn,.theme-toggle,button{border-width:.5px}}@media (prefers-reduced-motion:reduce){*{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important}}@media (max-width:768px){body.dark-theme .container{background:rgba(26,32,44,.98)}body.dark-theme table{background:#2d3748}body.dark-theme th{background:linear-gradient(135deg,#2d3748 0,#4a5568 100%)}body.dark-theme td{border-bottom-color:#4a5568}}.mobile-only{display:none}.desktop-only{display:block}@media (max-width:768px){.mobile-only{display:block}.desktop-only{display:none}}@media (hover:none) and (pointer:coarse){.export-btn:hover,button:hover,input:hover,select:hover{transform:none;box-shadow:none}.export-btn:active,button:active{transform:scale(.98)}}@media (max-width:768px){input[type=email],input[type=search],input[type=text]{-webkit-appearance:none;border-radius:10px}select{-webkit-appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 10px center;background-size:16px;padding-right:40px}}.export-container{display:none;gap:15px;justify-content:center;margin:20px 0;animation:fadeIn .8s ease-out;opacity:0;transform:translateY(20px);transition:all .5s ease}.export-container.show{display:flex;opacity:1;transform:translateY(0)}@media (max-width:768px){.container{animation:slideInUpMobile .4s cubic-bezier(.25,.46,.45,.94);will-change:transform,opacity}@keyframes slideInUpMobile{from{opacity:0;transform:translateY(20px) scale(.98)}to{opacity:1;transform:translateY(0) scale(1)}}.header{animation:fadeInDownMobile .5s cubic-bezier(.25,.46,.45,.94)}@keyframes fadeInDownMobile{from{opacity:0;transform:translateY(-15px)}to{opacity:1;transform:translateY(0)}}.search-container{animation:fadeInUpMobile .6s cubic-bezier(.25,.46,.45,.94) .1s both}@keyframes fadeInUpMobile{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}button,input,select{transition:all .2s cubic-bezier(.25, .46, .45, .94);will-change:transform,box-shadow}button:active,select:active{transform:scale(.96);transition:transform .1s cubic-bezier(.25, .46, .45, .94)}.export-container.show{animation:slideInUpExport .4s cubic-bezier(.25,.46,.45,.94)}@keyframes slideInUpExport{from{opacity:0;transform:translateY(10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}#results{animation:fadeInScale .5s cubic-bezier(.25,.46,.45,.94)}@keyframes fadeInScale{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}#status{animation:slideInStatus .3s cubic-bezier(.25,.46,.45,.94)}@keyframes slideInStatus{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}input:focus,select:focus{transform:translateY(-2px) scale(1.02);transition:all .2s cubic-bezier(.25, .46, .45, .94)}.loading{animation:spinMobile .8s linear infinite}@keyframes spinMobile{from{transform:rotate(0)}to{transform:rotate(360deg)}}.theme-toggle{transition:all .3s cubic-bezier(.25, .46, .45, .94)}.theme-toggle:active{transform:scale(.9);transition:transform .1s cubic-bezier(.25, .46, .45, .94)}.mobile-table-wrapper{animation:slideInTable .4s cubic-bezier(.25,.46,.45,.94)}@keyframes slideInTable{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes pulseMobile{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(1.02)}}#status{animation:pulseMobile 2s ease-in-out infinite}@keyframes exportSuccessMobile{0%{transform:scale(1);box-shadow:0 4px 15px rgba(0,0,0,.1)}50%{transform:scale(1.05);box-shadow:0 8px 25px rgba(0,0,0,.2)}100%{transform:scale(1);box-shadow:0 4px 15px rgba(0,0,0,.1)}}.export-success{animation:exportSuccessMobile .4s cubic-bezier(.25,.46,.45,.94)}}@media (prefers-reduced-motion:reduce){*{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important}}@media (min-resolution:2dppx){#results,.container,.export-container,.header,.search-container{will-change:transform,opacity}}#progressBar{display:none;width:100%;background:#2d3748;height:8px;border-radius:4px;overflow:hidden;margin-bottom:16px;box-shadow:0 2px 8px rgba(102,126,234,.15)}#progressBarInner{width:0;height:100%;background:linear-gradient(90deg,#667eea 0,#f093fb 100%);transition:width .3s;border-radius:4px;box-shadow:0 0 8px #667eea66}body.dark-theme #progressBar{background:#1a1a2e}body.dark-theme #progressBarInner{background:linear-gradient(90deg,#48bb78 0,#38a169 100%);box-shadow:0 0 8px #48bb7866}@media (max-width:600px){.search-container{flex-direction:column;align-items:stretch;gap:16px;margin-bottom:24px}.search-container label{margin-bottom:4px;font-size:1rem}.search-container input,.search-container select{width:100%;font-size:1.1rem;min-height:48px;margin-bottom:0}.search-container button{width:100%;font-size:1.1rem;min-height:48px;margin-bottom:0;margin-left:0!important}}.search-container button{margin-top:8px;margin-bottom:8px;border-radius:12px;font-weight:700;letter-spacing:.5px;box-shadow:0 2px 8px rgba(102,126,234,.1);transition:background .2s,transform .1s}.search-container button:active{transform:scale(.97)}#searchBtn{background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;border:none}#searchBtn:focus,#searchBtn:hover{background:linear-gradient(90deg,#5a67d8 0,#6b46c1 100%)}#clearBtn{background:#f56565;color:#fff;border:none}#clearBtn:focus,#clearBtn:hover{background:#e53e3e}@media (max-width:600px){h2{font-size:1.5rem;margin-bottom:18px}.container{padding:16px 6px;border-radius:12px}}@media (max-width:768px){.mobile-table-wrapper{overflow-x:auto!important;-webkit-overflow-scrolling:touch!important;width:100%!important;display:block!important}.mobile-table-wrapper table{min-width:600px!important;width:max-content!important;display:table!important}table{width:max-content!important;min-width:600px!important;display:table!important;max-height:none!important;overflow-y:visible!important}td,th{white-space:nowrap!important;text-overflow:ellipsis;overflow:hidden;max-width:200px}}#columnDropdownBtn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;border:none;border-radius:10px;padding:12px 22px;font-size:1.08rem;font-weight:600;cursor:pointer;margin:10px 0 18px 0;box-shadow:0 2px 8px rgba(102,126,234,.1);transition:background .2s,transform .1s;position:relative;z-index:20}#columnDropdownBtn:active{transform:scale(.97)}#columnDropdown{display:none;position:absolute;left:0;top:100%;min-width:210px;max-width:92vw;background:rgba(255,255,255,.65);border-radius:16px;box-shadow:0 8px 32px rgba(102,126,234,.18);padding:14px 14px 8px 14px;margin-top:6px;z-index:100;flex-direction:column;gap:8px;animation:fadeInDropdown .18s;backdrop-filter:blur(18px) saturate(1.3);-webkit-backdrop-filter:blur(18px) saturate(1.3);border:1.5px solid rgba(120,120,180,.13)}@keyframes fadeInDropdown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}#columnDropdown.open{display:flex}#columnDropdown label{display:flex;align-items:center;gap:7px;font-weight:400;font-size:.98rem;margin:0 0 6px 0;cursor:pointer}#columnDropdown input[type=checkbox]{accent-color:#764ba2;width:18px;height:18px;margin:0 4px 0 0;cursor:pointer}#columnDropdown .dropdown-actions{display:flex;justify-content:flex-end;margin-top:4px}#columnDropdown .dropdown-close{background:#764ba2;color:#fff;border:none;border-radius:8px;padding:6px 16px;font-size:.98rem;cursor:pointer;margin-left:8px;box-shadow:0 2px 8px rgba(102,126,234,.1)}@media (max-width:768px){#columnDropdown{left:50%;top:60px;transform:translateX(-50%);width:95vw;max-width:350px;min-width:180px;max-height:45vh;overflow-y:auto;border-radius:12px;box-shadow:0 4px 18px rgba(102,126,234,.13);padding:14px 12px 10px 12px;margin-top:0;z-index:3000;background:rgba(255,255,255,.95);backdrop-filter:blur(10px) saturate(1.1);-webkit-backdrop-filter:blur(10px) saturate(1.1);border:1.5px solid rgba(120,120,180,.13);animation:fadeInDropdown .18s;display:none;flex-direction:column;gap:6px;box-sizing:border-box}#columnDropdown.open{display:flex}#columnDropdown label{font-size:1rem;color:#222;font-weight:500;margin:0 0 4px 0;gap:2px;line-height:1.3;letter-spacing:.01em;display:flex;align-items:center;white-space:normal;word-break:break-word}#columnDropdown input[type=checkbox]{width:18px!important;height:18px!important;min-height:unset!important;margin:0 1px 0 0;accent-color:#764ba2;vertical-align:middle;flex-shrink:0}#columnDropdown .dropdown-close{width:100%;font-size:1.05rem;padding:10px 0;margin:10px 0 0 0;border-radius:8px;background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;font-weight:600;letter-spacing:.5px}}.skeleton-table{width:100%;max-width:900px;min-width:600px;border-collapse:separate;border-spacing:0 8px;margin:20px auto;background:linear-gradient(120deg,#f3f3f3 60%,#e2e8f0 100%);border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(118,75,162,.08);border:1.5px solid #e2e8f0;opacity:1;transition:opacity .45s cubic-bezier(.4,0,.2,1)}.skeleton-table.hide{opacity:0}.skeleton-cell{min-width:120px;height:28px;background:linear-gradient(90deg,#f3f3f3 25%,#e2e8f0 50%,#f3f3f3 75%);background-size:200% 100%;animation:skeleton-loading 1.2s infinite linear,skeleton-shimmer 2.2s infinite linear;border-radius:8px;margin:0 6px;box-shadow:0 1px 4px rgba(118,75,162,.1);border:1px solid #e2e8f0}.skeleton-header-cell{min-width:150px;height:32px;background:linear-gradient(90deg,#e2e8f0 20%,#f3f3f3 60%,#e2e8f0 100%);background-size:200% 100%;animation:skeleton-header-loading 1.6s infinite linear,skeleton-pulse 1.8s infinite cubic-bezier(.4,0,.6,1);border-radius:8px;margin:0 6px;box-shadow:0 2px 8px rgba(118,75,162,.13);border:1px solid #e2e8f0}.skeleton-btn-placeholder{width:120px;height:36px;border-radius:8px;background:linear-gradient(90deg,#f3f3f3 25%,#e2e8f0 50%,#f3f3f3 75%);background-size:200% 100%;animation:skeleton-loading 1.2s infinite linear;margin:18px 12px 0 0;display:inline-flex;align-items:center;box-shadow:0 1px 4px rgba(118,75,162,.1);border:1px solid #e2e8f0}.skeleton-icon{width:28px;height:28px;border-radius:50%;background:linear-gradient(90deg,#f3f3f3 25%,#e2e8f0 50%,#f3f3f3 75%);background-size:200% 100%;animation:skeleton-loading 1.2s infinite linear;display:inline-block;margin-right:10px;vertical-align:middle}@keyframes skeleton-loading{0%{background-position:200% 0}100%{background-position:-200% 0}}@keyframes skeleton-header-loading{0%{background-position:100% 0}100%{background-position:-100% 0}}@keyframes skeleton-shimmer{0%{filter:brightness(1)}50%{filter:brightness(1.08)}100%{filter:brightness(1)}}@keyframes skeleton-pulse{0%,100%{box-shadow:0 2px 8px rgba(118,75,162,.13)}50%{box-shadow:0 4px 16px rgba(118,75,162,.18)}}@media (prefers-reduced-motion:reduce){.skeleton-btn-placeholder,.skeleton-cell,.skeleton-header-cell,.skeleton-icon{animation:none!important}}</style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="main-nav">
    <a href="index.html" class="nav-link" title="Home"><span class="nav-icon">🏠</span><span class="nav-label">Home</span></a>
    <a href="pending.html" class="nav-link" title="Pending Order Forms"><span class="nav-icon">⏳</span><span class="nav-label">Pending</span></a>
    <a href="paid.html" class="nav-link active" title="Paid Payments"><span class="nav-icon">✅</span><span class="nav-label">Paid</span></a>
</nav>
<style>
    .main-nav {
        position: fixed;
        top: 0; left: 0; right: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 18px;
        background: rgba(255,255,255,0.85);
        box-shadow: 0 2px 16px 0 #764ba222;
        z-index: 1001;
        padding: 10px 0 6px 0;
        backdrop-filter: blur(8px) saturate(1.2);
    }
    .nav-link {
        display: flex;
        align-items: center;
        gap: 7px;
        font-size: 1.08rem;
        font-weight: 600;
        color: #764ba2;
        text-decoration: none;
        padding: 7px 18px;
        border-radius: 12px;
        transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        position: relative;
    }
    .nav-link .nav-icon {
        font-size: 1.2em;
    }
    .nav-link.active, .nav-link:hover {
        background: linear-gradient(90deg, #f3e8ff 0%, #e9d8fd 100%);
        color: #4a5568;
        box-shadow: 0 2px 8px #764ba222;
    }
    @media (max-width: 600px) {
        .main-nav {
            gap: 6px;
            padding: 7px 0 3px 0;
        }
        .nav-link {
            font-size: 0.98rem;
            padding: 6px 10px;
            gap: 4px;
        }
        .nav-link .nav-label {
            display: none;
        }
    }
</style>
<div style="height:54px;"></div> <!-- Spacer for nav -->
<div class=container>
<div class=header>
<h2>AF Deal Payment Tracker</h2>
<button id=themeToggle class=theme-toggle onclick=toggleTheme()>
<div class=logo-container>
<div class=logo-icon>
<div class=sun-rays></div>
<div class=moon-crescent></div>
</div>
</div>
</button>
</div>
<div class=search-container>
<label for=searchType>Search By:</label>
<select id=searchType onchange=updateSearchButtonState()>
<option value="" disabled selected>Select search option</option>
<option value="Email Address">Email ID</option>
<option value="Order Id">Order ID</option>
<option value="WhatsApp Number">WhatsApp Number</option>
</select>
<input id=searchValue placeholder="Enter search value" oninput=updateSearchButtonState()>
<button id=searchBtn onclick=searchNow() disabled>Search</button>
<button id=clearBtn onclick=clearSearch() style=margin-left:10px;background:#f56565>Clear</button>
</div>
<div id=inputLog></div>
<div id=status></div>
<div id=totalCashback style="display:none;font-weight:700;font-size:1.2rem;color:#38a169;margin:10px 0 20px 0;text-align:center"></div>
<div id=searchWithinContainer style="display:none;margin:10px 0 0 0;text-align:center">
<input id=searchWithinInput placeholder="Search within results..." style="max-width:350px;width:90%;padding:10px;border-radius:8px;border:1.5px solid #e2e8f0;font-size:1rem;margin:0 auto" oninput=debouncedSearchWithinResults()>
</div>
<div style=position:relative;z-index:20;display:none id=columnDropdownContainer>
<button id=columnDropdownBtn type=button onclick=toggleColumnDropdown(event)>
<span style=font-size:1.1em>☰</span> Show/Hide Columns
</button>
<div id=columnDropdown></div>
</div>
<div id=results></div>
<div id=exportContainer class=export-container>
<button id=exportPdf class="export-btn export-pdf" onclick=exportToPDF() disabled>
<span class=icon>📄</span>
<span>Export PDF</span>
</button>
<button id=exportExcel class="export-btn export-excel" onclick=exportToExcel() disabled>
<span class=icon>📊</span>
<span>Export Excel</span>
</button>
</div>
</div>
<script>let currentTheme=localStorage.getItem("theme")||"light";function toggleTheme(){currentTheme="light"===currentTheme?"dark":"light",applyTheme(currentTheme),localStorage.setItem("theme",currentTheme);const e=document.getElementById("themeToggle");e.style.transform="scale(0.9)",setTimeout((()=>{e.style.transform=""}),150)}function applyTheme(e){const t=document.body,n=document.querySelector(".logo-icon");"dark"===e?(t.classList.add("dark-theme"),n.style.transform="rotate(180deg)",setTimeout((()=>{n.style.transform=""}),500)):(t.classList.remove("dark-theme"),n.style.transform="rotate(-180deg)",setTimeout((()=>{n.style.transform=""}),500))}document.addEventListener("DOMContentLoaded",(function(){applyTheme(currentTheme)}));let sortColumn=null,sortDirection=1,currentPage=1;const PAGE_SIZE=10;function searchNow(){const e=document.getElementById("searchType").value,t=document.getElementById("searchValue").value.trim(),n=document.getElementById("status"),o=document.getElementById("inputLog"),s=document.getElementById("results");var r=document.getElementById("totalCashback");r&&(r.innerHTML="Total cashback amount: <span style='color:#764ba2;'>₹0.00</span>",r.style.display="");var a=document.getElementById("columnDropdownContainer");if(a){a.style.display="block";var i=document.getElementById("columnDropdownBtn");i&&(i.disabled=!0)}if(!t)return n.innerText="Please enter a value.",n.className="error",void hideExportButtons();window.searchResultsOriginal=[],window.searchResultsView=[];let l=5;window.lastColumns&&window.lastColumns.length&&(l=window.lastColumns.length);let d=window.innerWidth>900?8:5,c='<table class="skeleton-table">';c+='<tr class="skeleton-row">';for(let e=0;e<l;e++)c+='<td class="skeleton-header-cell"></td>';c+="</tr>";for(let e=0;e<d;e++){c+='<tr class="skeleton-row">';for(let e=0;e<l;e++)c+='<td class="skeleton-cell"></td>';c+="</tr>"}c+="</table>",c+='<div style="display:flex;gap:12px;margin-top:10px;">',c+='<div class="skeleton-btn-placeholder"><div class="skeleton-icon"></div></div>',c+='<div class="skeleton-btn-placeholder"><div class="skeleton-icon"></div></div>',c+="</div>",s.innerHTML=c,s.setAttribute("aria-busy","true"),s.setAttribute("role","status"),s.setAttribute("aria-label","Loading results"),n.innerText="Searching...",n.className="info",o.innerText=`You searched for: "${t}"`,hideExportButtons();const u=`https://script.google.com/macros/s/AKfycbynWNIYdXMV94eyw1cqGmFGhXJLZZz326ZzdHXO2vAhl3M8aBdPt9RAMpcL-0gXzk0g5Q/exec?type=${encodeURIComponent(e)}&value=${encodeURIComponent(t)}`;fetch(u).then((e=>e.json())).then((o=>{if(!o.results||0===o.results.length)return n.innerText="No results found. Try a different search.",n.className="error",hideExportButtons(),s.innerHTML="<div style='color:#888; text-align:center; margin:30px 0;'>No results found. Try a different search.</div>",window.searchResultsOriginal=[],window.searchResultsView=[],document.getElementById("searchWithinInput").value="",void(document.getElementById("searchWithinContainer").style.display="none");n.innerText=`Found ${o.results.length} result${1!==o.results.length?"s":""}.`,n.className="success",window.searchResultsOriginal=o.results,window.searchResultsView=[...o.results],sortColumn=null,sortDirection=1,currentPage=1,window.searchQuery={type:e,value:t},window.lastColumns=Object.keys(o.results[0]||{});const r=document.querySelector(".skeleton-table");r?(r.classList.add("hide"),setTimeout((()=>{s.removeAttribute("aria-busy"),s.removeAttribute("role"),s.removeAttribute("aria-label"),renderResultsPage(),showExportButtons()}),300)):(renderResultsPage(),showExportButtons())})).catch((e=>{console.error("Fetch error:",e),n.innerText="Error fetching data.",n.className="error",hideExportButtons()}))}function renderResultsPage(){const e=document.getElementById("results"),t=window.searchResultsView||[],n=document.getElementById("searchWithinContainer"),o=document.getElementById("columnDropdownContainer");if(window.searchResultsOriginal&&window.searchResultsOriginal.length>0?(n.style.display="",o&&(o.style.display="block",document.getElementById("columnDropdownBtn").disabled=!1)):(n.style.display="none",o&&(o.style.display="none")),0===t.length)return document.getElementById("totalCashback").style.display="none",void(e.innerHTML="<div>No results to display.</div>");let s=0;t.forEach((e=>{let t=e["Payment amt"];"string"==typeof t&&(t=t.replace(/[^\d.\-]/g,"")),t=parseFloat(t),isNaN(t)||(s+=t)}));const r=document.getElementById("totalCashback");r.innerHTML=`Total cashback amount: <span style='color:#764ba2;'>₹${s.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,r.style.display="";const a=Object.keys(t[0]);renderColumnToggles(a);const i=a.filter((e=>!window.hiddenColumns.includes(e)));let l="<table><tr>";i.forEach((e=>{l+=`<th onclick="sortByColumn('${e}')" style="cursor:pointer;user-select:none;">${e}`,l+=sortColumn===e?1===sortDirection?" ▲":" ▼":' <span style="color:#bbb;">▲</span>',l+="</th>"})),l+="</tr>",t.forEach((e=>{l+="<tr>",i.forEach((t=>{let n=e[t];"WhatsApp Number"===t&&(n=maskWhatsAppNumber(n)),"Payment Date"===t&&"string"==typeof n&&n.match(/^\d{4}-\d{2}-\d{2}T/)&&(n=formatDateToDDMMYYYY(n)),l+=`<td>${n}</td>`})),l+="</tr>"})),l+="</table>",window.innerWidth<=768&&(l=`<div class="mobile-table-wrapper" style="overflow-x: auto; -webkit-overflow-scrolling: touch; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">${l}</div>`),e.innerHTML=l}function sortByColumn(e){sortColumn===e?sortDirection*=-1:(sortColumn=e,sortDirection=1),window.searchResultsView=[...window.searchResultsOriginal].sort(((t,n)=>t[e]<n[e]?-1*sortDirection:t[e]>n[e]?1*sortDirection:0)),currentPage=1,renderResultsPage()}function showExportButtons(){const e=document.getElementById("exportContainer"),t=document.getElementById("exportPdf"),n=document.getElementById("exportExcel");t.disabled=!1,n.disabled=!1,e.classList.add("show")}function hideExportButtons(){const e=document.getElementById("exportContainer"),t=document.getElementById("exportPdf"),n=document.getElementById("exportExcel");t.disabled=!0,n.disabled=!0,e.classList.remove("show")}function exportToPDF(){if(!window.searchResultsOriginal||0===window.searchResultsOriginal.length)return void alert("No data to export!");const e=document.getElementById("exportPdf");e.classList.add("loading"),e.disabled=!0;try{const{jsPDF:t}=window.jspdf,n=new t,o=`Order Search Results - ${window.searchQuery.type}: ${window.searchQuery.value}`;n.setFontSize(16),n.setFont(void 0,"bold"),n.text(o,14,20),n.setFontSize(10),n.setFont(void 0,"normal"),n.text(`Search Date: ${(new Date).toLocaleString()}`,14,30),n.text(`Total Results: ${window.searchResultsOriginal.length}`,14,35);const s=Object.keys(window.searchResultsOriginal[0]),r=window.searchResultsOriginal.map((e=>Object.values(e)));n.autoTable({head:[s],body:r,startY:45,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[102,126,234],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{top:45}});const a=`order_search_${window.searchQuery.type.replace(/\s+/g,"_")}_${window.searchQuery.value.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;n.save(a),e.classList.remove("loading"),e.classList.add("export-success"),setTimeout((()=>{e.classList.remove("export-success"),e.disabled=!1}),500)}catch(t){console.error("PDF export error:",t),alert("Error generating PDF. Please try again."),e.classList.remove("loading"),e.disabled=!1}}function exportToExcel(){if(!window.searchResultsOriginal||0===window.searchResultsOriginal.length)return void alert("No data to export!");const e=document.getElementById("exportExcel");e.classList.add("loading"),e.disabled=!0;try{const t=XLSX.utils.book_new(),n=[Object.keys(window.searchResultsOriginal[0]),["Search Type",window.searchQuery.type],["Search Value",window.searchQuery.value],["Search Date",(new Date).toLocaleString()],["Total Results",window.searchResultsOriginal.length],[],...window.searchResultsOriginal.map((e=>Object.values(e)))],o=XLSX.utils.aoa_to_sheet(n),s=XLSX.utils.decode_range(o["!ref"]);for(let e=s.s.c;e<=s.e.c;e++){const t=XLSX.utils.encode_cell({r:0,c:e});o[t]&&(o[t].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"667EEA"}}})}XLSX.utils.book_append_sheet(t,o,"Order Search Results");const r=`order_search_${window.searchQuery.type.replace(/\s+/g,"_")}_${window.searchQuery.value.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.xlsx`;XLSX.writeFile(t,r),e.classList.remove("loading"),e.classList.add("export-success"),setTimeout((()=>{e.classList.remove("export-success"),e.disabled=!1}),500)}catch(t){console.error("Excel export error:",t),alert("Error generating Excel file. Please try again."),e.classList.remove("loading"),e.disabled=!1}}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("exportContainer"),t=document.getElementById("exportPdf"),n=document.getElementById("exportExcel");if(e.classList.remove("show"),t.disabled=!0,n.disabled=!0,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){document.body.classList.add("mobile-device"),document.querySelectorAll("button, select, input").forEach((e=>{e.addEventListener("touchstart",(function(){this.style.transform="scale(0.98)"})),e.addEventListener("touchend",(function(){this.style.transform=""}))}));let e=0;document.addEventListener("touchend",(function(t){const n=(new Date).getTime();n-e<=300&&t.preventDefault(),e=n}),!1)}window.addEventListener("orientationchange",(function(){setTimeout((function(){const e=document.getElementById("results");if(e.innerHTML&&window.searchResultsOriginal){const t=window.innerWidth<=768,n=e.querySelector("table");if(n&&t&&!n.parentElement.classList.contains("mobile-table-wrapper")){const e=document.createElement("div");e.className="mobile-table-wrapper",e.style.cssText="overflow-x: auto; -webkit-overflow-scrolling: touch; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);",n.parentNode.insertBefore(e,n),e.appendChild(n)}}}),100)}))}));let searchWithinTimeout=null;function debouncedSearchWithinResults(){searchWithinTimeout&&clearTimeout(searchWithinTimeout),searchWithinTimeout=setTimeout(searchWithinResults,300)}function searchWithinResults(){const e=document.getElementById("searchWithinInput").value.trim().toLowerCase();window.searchResultsOriginal&&(window.searchResultsView=e?window.searchResultsOriginal.filter((t=>Object.values(t).some((t=>String(t).toLowerCase().includes(e))))):[...window.searchResultsOriginal],renderResultsPage())}function maskWhatsAppNumber(e){const t=String(e);return t.length<=6?t.replace(/./g,"*"):t.slice(0,3)+"****"+t.slice(-3)}function updateSearchButtonState(){const e=document.getElementById("searchType").value,t=document.getElementById("searchValue").value.trim();document.getElementById("searchBtn").disabled=!e||!t}function clearSearch(){document.getElementById("searchType").selectedIndex=0,document.getElementById("searchValue").value="",document.getElementById("inputLog").innerText="",document.getElementById("status").innerText="",document.getElementById("status").className="",document.getElementById("results").innerHTML="",document.getElementById("searchWithinInput").value="",document.getElementById("searchWithinContainer").style.display="none",hideExportButtons(),window.searchResultsOriginal=[],window.searchResultsView=[],sortColumn=null,sortDirection=1,currentPage=1,updateSearchButtonState();var e=document.getElementById("totalCashback");e&&(e.style.display="none");var t=document.getElementById("columnDropdownContainer");t&&(t.style.display="none"),window.hiddenColumns=[]}function formatDateToDDMMYYYY(e){if(!e)return"";const t=new Date(e);return isNaN(t)?e:`${String(t.getDate()).padStart(2,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${t.getFullYear()}`}function renderColumnToggles(e){const t=document.getElementById("columnDropdown");e&&0!==e.length?t.innerHTML=e.map((e=>`\n    <label>\n      <input type="checkbox" value="${e}" ${window.hiddenColumns.includes(e)?"":"checked"} onchange="toggleColumnVisibility(this)"> ${e}\n    </label>\n  `)).join("")+'\n    <div class="dropdown-actions">\n      <button class="dropdown-close" type="button" onclick="closeColumnDropdown()">Done</button>\n    </div>\n  ':t.innerHTML=""}function toggleColumnDropdown(e){e.stopPropagation();const t=document.getElementById("columnDropdown");t.classList.toggle("open"),t.classList.contains("open")?document.addEventListener("click",closeDropdownOnOutside,{capture:!0}):document.removeEventListener("click",closeDropdownOnOutside,{capture:!0})}function closeDropdownOnOutside(e){const t=document.getElementById("columnDropdown"),n=document.getElementById("columnDropdownBtn");t.contains(e.target)||n.contains(e.target)||(t.classList.remove("open"),document.removeEventListener("click",closeDropdownOnOutside,{capture:!0}))}function closeColumnDropdown(){document.getElementById("columnDropdown").classList.remove("open"),document.removeEventListener("click",closeDropdownOnOutside,{capture:!0})}function toggleColumnVisibility(e){const t=e.value;e.checked?window.hiddenColumns=window.hiddenColumns.filter((e=>e!==t)):window.hiddenColumns.includes(t)||window.hiddenColumns.push(t),renderResultsPage()}window.hiddenColumns=[];const KeyboardShortcuts={shortcuts:{"Ctrl+K":{action:"focusSearch",description:"Focus on search input"},Enter:{action:"performSearch",description:"Perform search"},"Ctrl+E":{action:"exportExcel",description:"Export to Excel"},"Ctrl+P":{action:"exportPDF",description:"Export to PDF"},"Ctrl+T":{action:"toggleTheme",description:"Toggle dark/light theme"},"Ctrl+C":{action:"toggleColumns",description:"Toggle column visibility"},"Ctrl+F":{action:"focusSearchWithin",description:"Focus on search within results"},Escape:{action:"clearSearch",description:"Clear search and results"},"Ctrl+?":{action:"showHelp",description:"Show keyboard shortcuts help"},"Ctrl+R":{action:"refreshResults",description:"Refresh current results"},"Ctrl+Shift+A":{action:"saveSearch",description:"Save current search"},"Ctrl+Shift+L":{action:"loadLastSearch",description:"Load last saved search"}},init:function(){this.createHelpModal(),this.bindShortcuts(),this.showWelcomeMessage()},bindShortcuts:function(){document.addEventListener("keydown",(e=>{if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName)return void("Escape"===e.key&&(e.preventDefault(),this.executeShortcut("clearSearch")));const t=this.getKeyCombo(e);this.shortcuts[t]&&(e.preventDefault(),this.executeShortcut(this.shortcuts[t].action))})),document.getElementById("searchValue").addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),this.executeShortcut("performSearch"))}));const e=document.getElementById("searchWithinInput");e&&e.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),debouncedSearchWithinResults())}))},getKeyCombo:function(e){let t="";return e.ctrlKey&&(t+="Ctrl+"),e.shiftKey&&(t+="Shift+"),e.altKey&&(t+="Alt+"),t+=e.key.toUpperCase(),t},executeShortcut:function(e){switch(e){case"focusSearch":document.getElementById("searchValue").focus(),this.showToast("Search input focused");break;case"performSearch":document.getElementById("searchBtn").disabled?this.showToast("Please select search type and enter a value","warning"):(searchNow(),this.showToast("Searching..."));break;case"exportExcel":document.getElementById("exportExcel").disabled?this.showToast("No data to export","warning"):(exportToExcel(),this.showToast("Exporting to Excel..."));break;case"exportPDF":document.getElementById("exportPdf").disabled?this.showToast("No data to export","warning"):(exportToPDF(),this.showToast("Exporting to PDF..."));break;case"toggleTheme":toggleTheme(),this.showToast("Theme toggled");break;case"toggleColumns":document.getElementById("columnDropdown")&&(toggleColumnDropdown({stopPropagation:()=>{}}),this.showToast("Column visibility toggled"));break;case"focusSearchWithin":const e=document.getElementById("searchWithinInput");e&&"none"!==e.style.display?(e.focus(),this.showToast("Search within results focused")):this.showToast("No results to search within","warning");break;case"clearSearch":clearSearch(),this.showToast("Search cleared");break;case"showHelp":this.showHelpModal();break;case"refreshResults":window.searchResultsOriginal&&window.searchResultsOriginal.length>0?(searchNow(),this.showToast("Results refreshed")):this.showToast("No results to refresh","warning");break;case"saveSearch":this.saveCurrentSearch();break;case"loadLastSearch":this.loadLastSearch()}window.Analytics&&window.Analytics.trackEvent("keyboard_shortcut_used",{shortcut_action:e,shortcut_category:"user_productivity"})},createHelpModal:function(){const e=document.createElement("div");e.id="keyboardHelpModal",e.innerHTML='\n            <div class="keyboard-help-overlay">\n                <div class="keyboard-help-modal">\n                    <div class="keyboard-help-header">\n                        <h3>🎹 Keyboard Shortcuts</h3>\n                        <button class="keyboard-help-close" onclick="KeyboardShortcuts.hideHelpModal()">×</button>\n                    </div>\n                    <div class="keyboard-help-content">\n                        <div class="shortcuts-section">\n                            <h4>🔍 Search & Navigation</h4>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+K</kbd>\n                                <span>Focus on search input</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Enter</kbd>\n                                <span>Perform search</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+F</kbd>\n                                <span>Focus on search within results</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Escape</kbd>\n                                <span>Clear search and results</span>\n                            </div>\n                        </div>\n                        <div class="shortcuts-section">\n                            <h4>📊 Export & Data</h4>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+E</kbd>\n                                <span>Export to Excel</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+P</kbd>\n                                <span>Export to PDF</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+C</kbd>\n                                <span>Toggle column visibility</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+R</kbd>\n                                <span>Refresh current results</span>\n                            </div>\n                        </div>\n                        <div class="shortcuts-section">\n                            <h4>🎨 Interface</h4>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+T</kbd>\n                                <span>Toggle dark/light theme</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+?</kbd>\n                                <span>Show this help</span>\n                            </div>\n                        </div>\n                        <div class="shortcuts-section">\n                            <h4>💾 Search Management</h4>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+Shift+A</kbd>\n                                <span>Save current search</span>\n                            </div>\n                            <div class="shortcut-item">\n                                <kbd>Ctrl+Shift+L</kbd>\n                                <span>Load last saved search</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="keyboard-help-footer">\n                        <p>💡 Tip: You can use these shortcuts anywhere on the page, except when typing in input fields.</p>\n                    </div>\n                </div>\n            </div>\n        ',document.body.appendChild(e)},showHelpModal:function(){const e=document.getElementById("keyboardHelpModal");if(e){e.style.display="flex";const t=e.querySelector(".keyboard-help-modal");t&&t.classList.add("show"),window.Analytics&&window.Analytics.trackEvent("help_modal_opened",{modal_type:"keyboard_shortcuts",user_type:"power_user"})}},hideHelpModal:function(){const e=document.getElementById("keyboardHelpModal");if(e){const t=e.querySelector(".keyboard-help-modal");t&&t.classList.remove("show"),setTimeout((()=>{e.style.display="none"}),300)}},showToast:function(e,t="info"){const n=document.querySelector(".keyboard-toast");n&&n.remove();const o=document.createElement("div");o.className=`keyboard-toast keyboard-toast-${t}`,o.innerHTML=`\n            <div class="toast-content">\n                <span class="toast-icon">${this.getToastIcon(t)}</span>\n                <span class="toast-message">${e}</span>\n            </div>\n        `,document.body.appendChild(o),setTimeout((()=>o.classList.add("show")),10),setTimeout((()=>{o.classList.remove("show"),setTimeout((()=>o.remove()),300)}),3e3)},getToastIcon:function(e){switch(e){case"success":return"✅";case"warning":return"⚠️";case"error":return"❌";default:return"💡"}},saveCurrentSearch:function(){const e=document.getElementById("searchType").value,t=document.getElementById("searchValue").value;if(e&&t){const n={type:e,value:t,timestamp:(new Date).toISOString()};localStorage.setItem("lastSearch",JSON.stringify(n)),this.showToast("Search saved successfully","success")}else this.showToast("No search to save","warning")},loadLastSearch:function(){const e=localStorage.getItem("lastSearch");if(e){const t=JSON.parse(e);document.getElementById("searchType").value=t.type,document.getElementById("searchValue").value=t.value,updateSearchButtonState(),this.showToast("Last search loaded","success")}else this.showToast("No saved search found","warning")},showWelcomeMessage:function(){localStorage.getItem("keyboardShortcutsShown")||setTimeout((()=>{this.showToast("💡 Press Ctrl+? to see keyboard shortcuts","info"),localStorage.setItem("keyboardShortcutsShown","true")}),2e3)}},keyboardShortcutsCSS="\n<style>\n/* Keyboard Help Modal */\n.keyboard-help-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.7);\n    display: none;\n    justify-content: center;\n    align-items: center;\n    z-index: 10000;\n    backdrop-filter: blur(5px);\n}\n\n.keyboard-help-modal {\n    background: rgba(255, 255, 255, 0.95);\n    border-radius: 20px;\n    padding: 0;\n    max-width: 600px;\n    width: 90%;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(15px);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    transform: scale(0.9);\n    opacity: 0;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.keyboard-help-modal.show {\n    transform: scale(1);\n    opacity: 1;\n}\n\n.keyboard-help-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 25px 30px 20px 30px;\n    border-bottom: 2px solid rgba(102, 126, 234, 0.1);\n}\n\n.keyboard-help-header h3 {\n    margin: 0;\n    color: #4a5568;\n    font-size: 1.5rem;\n    font-weight: 700;\n}\n\n.keyboard-help-close {\n    background: none;\n    border: none;\n    font-size: 2rem;\n    color: #718096;\n    cursor: pointer;\n    padding: 5px;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s ease;\n}\n\n.keyboard-help-close:hover {\n    background: rgba(102, 126, 234, 0.1);\n    color: #667eea;\n    transform: scale(1.1);\n}\n\n.keyboard-help-content {\n    padding: 25px 30px;\n}\n\n.shortcuts-section {\n    margin-bottom: 25px;\n}\n\n.shortcuts-section h4 {\n    color: #667eea;\n    font-size: 1.1rem;\n    font-weight: 600;\n    margin-bottom: 15px;\n    padding-bottom: 8px;\n    border-bottom: 1px solid rgba(102, 126, 234, 0.2);\n}\n\n.shortcut-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 12px;\n    padding: 8px 0;\n}\n\n.shortcut-item kbd {\n    background: linear-gradient(135deg, #667eea 0, #764ba2 100%);\n    color: white;\n    padding: 6px 12px;\n    border-radius: 8px;\n    font-family: 'Courier New', monospace;\n    font-size: 0.9rem;\n    font-weight: 600;\n    margin-right: 15px;\n    min-width: 80px;\n    text-align: center;\n    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.shortcut-item span {\n    color: #4a5568;\n    font-size: 1rem;\n    font-weight: 500;\n}\n\n.keyboard-help-footer {\n    padding: 20px 30px;\n    background: rgba(102, 126, 234, 0.05);\n    border-top: 1px solid rgba(102, 126, 234, 0.1);\n    border-radius: 0 0 20px 20px;\n}\n\n.keyboard-help-footer p {\n    margin: 0;\n    color: #718096;\n    font-size: 0.9rem;\n    text-align: center;\n}\n\n/* Toast Notifications */\n.keyboard-toast {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: rgba(255, 255, 255, 0.95);\n    border-radius: 12px;\n    padding: 15px 20px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    backdrop-filter: blur(15px);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    z-index: 10001;\n    transform: translateX(400px);\n    opacity: 0;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    max-width: 350px;\n}\n\n.keyboard-toast.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.keyboard-toast-success {\n    border-left: 4px solid #48bb78;\n}\n\n.keyboard-toast-warning {\n    border-left: 4px solid #ed8936;\n}\n\n.keyboard-toast-error {\n    border-left: 4px solid #f56565;\n}\n\n.keyboard-toast-info {\n    border-left: 4px solid #4299e1;\n}\n\n.toast-content {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.toast-icon {\n    font-size: 1.2rem;\n}\n\n.toast-message {\n    color: #4a5568;\n    font-weight: 500;\n    font-size: 0.95rem;\n}\n\n/* Dark theme support */\nbody.dark-theme .keyboard-help-modal {\n    background: rgba(26, 32, 44, 0.95);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\nbody.dark-theme .keyboard-help-header h3 {\n    color: #e2e8f0;\n}\n\nbody.dark-theme .shortcut-item span {\n    color: #e2e8f0;\n}\n\nbody.dark-theme .keyboard-help-footer {\n    background: rgba(102, 126, 234, 0.1);\n}\n\nbody.dark-theme .keyboard-help-footer p {\n    color: #a0aec0;\n}\n\nbody.dark-theme .keyboard-toast {\n    background: rgba(26, 32, 44, 0.95);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\nbody.dark-theme .toast-message {\n    color: #e2e8f0;\n}\n\n/* Mobile responsiveness */\n@media (max-width: 768px) {\n    .keyboard-help-modal {\n        width: 95%;\n        max-height: 90vh;\n        margin: 20px;\n    }\n    \n    .keyboard-help-header {\n        padding: 20px 20px 15px 20px;\n    }\n    \n    .keyboard-help-content {\n        padding: 20px;\n    }\n    \n    .keyboard-help-footer {\n        padding: 15px 20px;\n    }\n    \n    .shortcut-item {\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 8px;\n    }\n    \n    .shortcut-item kbd {\n        margin-right: 0;\n        min-width: auto;\n    }\n    \n    .keyboard-toast {\n        top: 10px;\n        right: 10px;\n        left: 10px;\n        max-width: none;\n        transform: translateY(-100px);\n    }\n    \n    .keyboard-toast.show {\n        transform: translateY(0);\n    }\n}\n\n/* Animation for keyboard shortcuts */\n@keyframes shortcutPulse {\n    0%, 100% { transform: scale(1); }\n    50% { transform: scale(1.05); }\n}\n\n.shortcut-item kbd:hover {\n    animation: shortcutPulse 0.3s ease-in-out;\n}\n\n/* Focus styles for accessibility */\n.keyboard-help-close:focus,\n.shortcut-item kbd:focus {\n    outline: 2px solid #667eea;\n    outline-offset: 2px;\n}\n</style>\n";document.head.insertAdjacentHTML("beforeend",keyboardShortcutsCSS),document.addEventListener("DOMContentLoaded",(function(){KeyboardShortcuts.init()})),document.addEventListener("click",(function(e){const t=document.getElementById("keyboardHelpModal");t&&e.target===t&&KeyboardShortcuts.hideHelpModal()})),document.addEventListener("keydown",(function(e){if("Escape"===e.key){const e=document.getElementById("keyboardHelpModal");e&&"flex"===e.style.display&&KeyboardShortcuts.hideHelpModal()}})),window.addEventListener("beforeunload",(function(){Analytics.trackEvent("page_unload",{unload_at:(new Date).toISOString()})}))</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2PRMZL2Z5X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2PRMZL2Z5X",{page_title:"AF Deal Payment Tracker - Main",custom_map:{custom_parameter_1:"user_device_type",custom_parameter_2:"user_session_duration",custom_parameter_3:"search_type_used",custom_parameter_4:"export_format_preference",custom_parameter_5:"column_visibility_changes"},allow_enhanced_conversions:!0,engagement_time_msec:1e4,send_page_view:!0});const Analytics={trackEvent:function(e,t={}){const n={...t,timestamp:(new Date).toISOString(),user_agent:navigator.userAgent,screen_resolution:`${screen.width}x${screen.height}`,viewport_size:`${window.innerWidth}x${window.innerHeight}`,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,session_id:this.getSessionId(),page_url:window.location.href};gtag("event",e,n),console.log(`Analytics Event: ${e}`,n)},trackSearch:function(e,t,n,i){this.trackEvent("search_performed",{search_type:e,search_value_length:t.length,results_count:n,search_duration_ms:i,search_success:n>0,search_category:"payment_tracker"})},trackExport:function(e,t,n){this.trackEvent("data_exported",{export_format:e,data_size:t,export_duration_ms:n,export_success:!0})},trackEngagement:function(e,t,n=null){this.trackEvent("user_engagement",{action_type:e,element_type:t,element_value:n,engagement_level:"interaction"})},trackColumnToggle:function(e,t){this.trackEvent("column_visibility_changed",{column_name:e,visibility_state:t?"visible":"hidden",total_visible_columns:this.getVisibleColumnsCount()})},trackSearchWithin:function(e,t,n){this.trackEvent("search_within_results",{search_query:e,filtered_results:t,original_results:n,filter_effectiveness:((n-t)/n*100).toFixed(2)})},trackSorting:function(e,t){this.trackEvent("table_sorted",{sort_column:e,sort_direction:t,sort_type:"user_initiated"})},trackThemeChange:function(e){this.trackEvent("theme_changed",{new_theme:e,previous_theme:"dark"===e?"light":"dark",user_preference:"manual"})},trackError:function(e,t,n){this.trackEvent("error_occurred",{error_type:e,error_message:t,error_context:n,error_severity:"medium"})},trackPerformance:function(e,t,n="ms"){this.trackEvent("performance_metric",{metric_name:e,metric_value:t,metric_unit:n,performance_category:"user_experience"})},trackUserSatisfaction:function(e,t){this.trackEvent("user_satisfaction",{satisfaction_action:e,satisfaction_level:t,satisfaction_metric:"interaction_based"})},trackConversion:function(e,t){this.trackEvent("conversion",{conversion_type:e,conversion_value:t,conversion_category:"payment_tracker"})},trackABTest:function(e,t,n){this.trackEvent("ab_test_interaction",{test_name:e,variant:t,action:n,test_category:"ui_enhancement"})},trackUserBehavior:function(e,t){this.trackEvent("user_behavior",{behavior_type:e,behavior_details:t,behavior_timestamp:(new Date).toISOString()})},trackScrollDepth:function(e){this.trackEvent("scroll_depth",{scroll_percentage:e,scroll_category:e>75?"deep":e>50?"medium":"shallow"})},trackTimeOnPage:function(e){this.trackEvent("time_on_page",{duration_seconds:e,engagement_level:e>300?"high":e>120?"medium":"low"})},trackFormInteraction:function(e,t){this.trackEvent("form_interaction",{form_element:e,interaction_action:t,form_type:"search_form"})},getSessionId:function(){return this.sessionId||(this.sessionId="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)),this.sessionId},getVisibleColumnsCount:function(){if(window.searchResultsOriginal&&window.searchResultsOriginal.length>0){return Object.keys(window.searchResultsOriginal[0]).length-(window.hiddenColumns?window.hiddenColumns.length:0)}return 0},init:function(){window.addEventListener("load",(()=>{const e=performance.now();this.trackPerformance("page_load_time",e),this.trackEvent("page_loaded",{load_time_ms:e,page_type:"main_tracker"})}));let e=0;window.addEventListener("scroll",(()=>{const t=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);t>e&&(e=t,t%25==0&&this.trackScrollDepth(t))}));let t=Date.now();setInterval((()=>{const e=Math.round((Date.now()-t)/1e3);e%60==0&&this.trackTimeOnPage(e)}),6e4),document.addEventListener("input",(e=>{e.target.matches("input, select")&&this.trackFormInteraction(e.target.id||e.target.name||"unknown","input")})),document.addEventListener("change",(e=>{e.target.matches("select")&&this.trackFormInteraction(e.target.id||e.target.name||"unknown","selection_changed")})),document.addEventListener("click",(e=>{e.target.matches("button")&&this.trackEngagement("button_click",e.target.id||e.target.textContent.trim())}));const n=window.toggleTheme;window.toggleTheme=function(){const e="light"===currentTheme?"dark":"light";Analytics.trackThemeChange(e),n()};const i=window.searchNow;window.searchNow=function(){const e=performance.now(),t=document.getElementById("searchType").value,n=document.getElementById("searchValue").value.trim();Analytics.trackEngagement("search_initiated","search_button");const r=window.fetch;window.fetch=function(i){return r.apply(this,arguments).then((i=>(i.clone().json().then((i=>{const r=performance.now()-e,a=i.results?i.results.length:0;Analytics.trackSearch(t,n,a,r),a>0?(Analytics.trackConversion("successful_search",a),Analytics.trackUserSatisfaction("search_success","high")):Analytics.trackUserSatisfaction("search_no_results","low")})).catch((e=>{Analytics.trackError("search_failed",e.message,"fetch_response")})),i))).catch((e=>{throw Analytics.trackError("search_failed",e.message,"fetch_request"),e}))},i(),window.fetch=r};const r=window.exportToPDF;window.exportToPDF=function(){const e=performance.now();Analytics.trackEngagement("export_initiated","pdf_export");try{r();const t=performance.now()-e,n=window.searchResultsOriginal?window.searchResultsOriginal.length:0;Analytics.trackExport("PDF",n,t),Analytics.trackConversion("pdf_export",1),Analytics.trackUserSatisfaction("export_success","high")}catch(e){Analytics.trackError("export_failed",e.message,"pdf_export"),Analytics.trackUserSatisfaction("export_failed","low")}};const a=window.exportToExcel;window.exportToExcel=function(){const e=performance.now();Analytics.trackEngagement("export_initiated","excel_export");try{a();const t=performance.now()-e,n=window.searchResultsOriginal?window.searchResultsOriginal.length:0;Analytics.trackExport("Excel",n,t),Analytics.trackConversion("excel_export",1),Analytics.trackUserSatisfaction("export_success","high")}catch(e){Analytics.trackError("export_failed",e.message,"excel_export"),Analytics.trackUserSatisfaction("export_failed","low")}};const o=window.toggleColumnVisibility;window.toggleColumnVisibility=function(e){const t=e.value,n=e.checked;Analytics.trackColumnToggle(t,n),o(e)};const c=window.searchWithinResults;window.searchWithinResults=function(){const e=document.getElementById("searchWithinInput").value.trim(),t=window.searchResultsOriginal?window.searchResultsOriginal.length:0;c();const n=window.searchResultsView?window.searchResultsView.length:0;Analytics.trackSearchWithin(e,n,t)};const s=window.sortByColumn;window.sortByColumn=function(e){const t=sortColumn===e&&1===t?-1:1;Analytics.trackSorting(e,1===t?"ascending":"descending"),s(e)};const l=window.clearSearch;window.clearSearch=function(){Analytics.trackEngagement("search_cleared","clear_button"),l()};let d=Date.now();["mousedown","mousemove","keypress","scroll","touchstart"].forEach((e=>{document.addEventListener(e,(()=>{const t=Date.now();t-d>3e4&&Analytics.trackUserBehavior("user_returned",{inactivity_duration:t-d,trigger_event:e}),d=t}))})),this.trackEvent("user_environment",{device_type:this.getDeviceType(),browser:this.getBrowserInfo(),os:this.getOSInfo(),connection_type:navigator.connection?navigator.connection.effectiveType:"unknown"}),console.log("Enhanced Analytics initialized")},getDeviceType:function(){const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/mobile|android|iphone|ipod|blackberry|opera mini|iemobile/i.test(e)?"mobile":"desktop"},getBrowserInfo:function(){const e=navigator.userAgent;return e.includes("Chrome")?"Chrome":e.includes("Firefox")?"Firefox":e.includes("Safari")?"Safari":e.includes("Edge")?"Edge":"Other"},getOSInfo:function(){const e=navigator.userAgent;return e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":e.includes("Android")?"Android":e.includes("iOS")?"iOS":"Other"}};document.addEventListener("DOMContentLoaded",(function(){Analytics.init()})),document.addEventListener("visibilitychange",(function(){document.hidden?Analytics.trackEvent("page_hidden",{hidden_at:(new Date).toISOString()}):Analytics.trackEvent("page_visible",{visible_at:(new Date).toISOString()})})),window.addEventListener("beforeunload",(function(){Analytics.trackEvent("page_unload",{unload_at:(new Date).toISOString()})}))</script>
    <!-- Register Service Worker for PWA -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('service-worker.js');
        });
      }
    </script>
    <!-- Internet Connection Status Banner -->
    <div id="connectionStatus" class="connection-status" style="display:none;">⚠️ Internet connection lost. Some features may not work.</div>
    <style>
      .connection-status {
        position: fixed; top: 0; left: 0; right: 0; z-index: 2000;
        background: #f56565; color: #fff; text-align: center;
        font-weight: 600; font-size: 1.08rem; padding: 10px 0;
        box-shadow: 0 2px 12px #e53e3e33;
        letter-spacing: 0.5px;
        animation: fadeIn 0.2s;
      }
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
      .custom-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(255,255,255,0.7);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10002;
        opacity: 0;
        animation: overlayFadeIn 0.35s cubic-bezier(.4,0,.2,1) forwards, overlayPulse 0.5s cubic-bezier(.4,0,.2,1);
        backdrop-filter: blur(8px) saturate(1.2);
      }
      @keyframes overlayFadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      @keyframes overlayPulse {
        0% { box-shadow: 0 0 0 0 #764ba244; }
        70% { box-shadow: 0 0 0 40px #764ba222; }
        100% { box-shadow: 0 0 0 0 #764ba200; }
      }
      .loading {
        display: inline-block;
        width: 48px;
        height: 48px;
        border: 5px solid rgba(118,75,162,0.15);
        border-radius: 50%;
        border-top: 5px solid #764ba2;
        border-right: 5px solid #667eea;
        border-bottom: 5px solid #f093fb;
        animation: spin 1s linear infinite, glow 1.2s ease-in-out infinite alternate;
        box-shadow: 0 0 18px 4px #764ba2aa;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      @keyframes glow {
        0% { box-shadow: 0 0 18px 4px #764ba2aa; }
        100% { box-shadow: 0 0 32px 10px #f093fbcc; }
      }
      .loading-text {
        margin-top: 24px;
        font-size: 1.3rem;
        color: #764ba2;
        font-weight: 600;
        letter-spacing: 1px;
        text-shadow: 0 2px 8px #fff8, 0 1px 0 #fff;
        animation: loadingTextFade 1.2s infinite alternate;
      }
      @keyframes loadingTextFade {
        0% { opacity: 0.7; }
        100% { opacity: 1; }
      }
    </style>
    <script>
      // Internet connection status
      function updateConnectionStatus() {
        const status = document.getElementById('connectionStatus');
        if (navigator.onLine) {
          status.style.display = 'none';
        } else {
          status.style.display = 'block';
        }
      }
      window.addEventListener('online', updateConnectionStatus);
      window.addEventListener('offline', updateConnectionStatus);
      document.addEventListener('DOMContentLoaded', updateConnectionStatus);
      // Navbar navigation with loading overlay
      function navNavigate(page) {
        let overlay = document.createElement('div');
        overlay.className = 'custom-overlay';
        overlay.innerHTML = '<div class="loading"></div><div class="loading-text">Loading...</div>';
        document.body.appendChild(overlay);
        setTimeout(() => {
          window.location.href = page;
        }, 700);
      }
      document.querySelectorAll('.navbar-link').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const page = this.getAttribute('href');
          navNavigate(page);
        });
      });
    </script>
    <div id="updateBanner" class="update-banner" style="display:none;">
      <span>🔄 A new version is available.</span>
      <button onclick="location.reload()" class="update-btn">Refresh</button>
    </div>
    <style>
      .update-banner {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        background: #764ba2;
        color: #fff;
        padding: 12px 24px;
        border-radius: 999px;
        box-shadow: 0 4px 18px #764ba244;
        font-size: 1.08rem;
        font-weight: 500;
        z-index: 3000;
        display: flex;
        align-items: center;
        gap: 18px;
        animation: fadeIn 0.3s;
      }
      .update-btn {
        background: #fff;
        color: #764ba2;
        border: none;
        border-radius: 999px;
        padding: 7px 18px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        margin-left: 10px;
        transition: background 0.2s, color 0.2s;
      }
      .update-btn:hover {
        background: #f3e8ff;
        color: #5a189a;
      }
    </style>
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.addEventListener('message', function(event) {
          if (event.data && event.data.type === 'NEW_VERSION_AVAILABLE') {
            document.getElementById('updateBanner').style.display = 'flex';
          }
        });
      }
    </script>
</body>
</html>